<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Freemana2017">
<meta property="og:url" content="http://yoursite.com/page/13/index.html">
<meta property="og:site_name" content="Freemana2017">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Freemana2017">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/13/">





  <title>Freemana2017</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>



<a href="https://github.com/Freemana2017" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>







    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Freemana2017</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/11/Docker/Docker加速/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/11/Docker/Docker加速/" itemprop="url">Docker镜像加速</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-11T11:35:27+08:00">
                2018-11-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/11/Docker/Docker加速/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/11/Docker/Docker加速/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>emmm。。。为什么图片可以使用 网上的地址？</p>
<p><a href="https://www.jianshu.com/p/94c6e44ebd3c" target="_blank" rel="noopener">https://www.jianshu.com/p/94c6e44ebd3c</a></p>
<p>不要使用https前缀， 负责会提示证书错误，</p>
<blockquote>
</blockquote>
<h1 id="Version-requires"><a href="#Version-requires" class="headerlink" title="Version requires:"></a>Version requires:</h1><h2 id="Docker-for-MAC-version"><a href="#Docker-for-MAC-version" class="headerlink" title="- Docker for MAC version:"></a>- Docker for MAC version:</h2><p><img src="https:////upload-images.jianshu.io/upload_images/10517010-1617f9ee81621ffe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/569/format/webp" alt="img"></p>
<p>docker version</p>
<h1 id="STEPS"><a href="#STEPS" class="headerlink" title="STEPS:"></a>STEPS:</h1><p>- Open docker -&gt;preference -&gt;Daemon-&gt;basic-&gt;Registry mirrors</p>
<p>添加：</p>
<blockquote>
<p><a href="http://registry.docker-cn.com" target="_blank" rel="noopener">http://registry.docker-cn.com</a></p>
</blockquote>
<p>Note：不要使用https前缀， 负责会提示证书错误，</p>
<blockquote>
<p>“registry-mirrors” :</p>
<p>  No certs for egitstry.docker.com</p>
</blockquote>
<p>导致dockerrestart failed。</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/10517010-37b53711599fae68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/498/format/webp" alt="img"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/11/Docker/Docker上传云服务器/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/11/Docker/Docker上传云服务器/" itemprop="url">Docker上传到腾讯云服务器上</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-11T11:35:27+08:00">
                2018-11-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/11/Docker/Docker上传云服务器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/11/Docker/Docker上传云服务器/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><a href="https://cloud.tencent.com/document/product/457/9117" target="_blank" rel="noopener">https://cloud.tencent.com/document/product/457/9117</a> 腾讯云</p>
<p><a href="https://study.163.com/course/courseLearn.htm?courseId=1006018194#/learn/video?lessonId=1053398787&amp;courseId=1006018194" target="_blank" rel="noopener">https://study.163.com/course/courseLearn.htm?courseId=1006018194#/learn/video?lessonId=1053398787&amp;courseId=1006018194</a> 小D课堂</p>
</blockquote>
<p>先选择容器服务 </p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022344.jpg" alt="image-20181209182853099"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo docker login --username=[username] ccr.ccs.tencentyun.com 	</span><br><span class="line">sudo docker login --username=100007660104 ccr.ccs.tencentyun.com 	</span><br><span class="line">100007660104sad</span><br></pre></td></tr></table></figure>
<p>username:腾讯云账号，开通时已注册。输入密码后即登录完成。<img src="/Users/apple/Desktop/屏幕快照 2018-11-15 下午5.44.02.png" alt="屏幕快照 2018-11-15 下午5.44.02"></p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022345.jpg" alt="image-20181115182444968"></p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022348.jpg" alt="image-20181115182457396"></p>
<p>##注意 用户名 不是QQ号登陆的密码而是仓库的用户名 第一次自动生成</p>
<p>####密码输入的时候先输入电脑root密码 z</p>
<p>###再输入密码yhp836143</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022349.jpg" alt="image-20181115182649857"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker tag [ImageId] ccr.ccs.tencentyun.com/[namespace]/[ImageName]:[镜像版本号]</span><br><span class="line">$ sudo docker push ccr.ccs.tencentyun.com/[namespace]/[ImageName]:[镜像版本号]</span><br></pre></td></tr></table></figure>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022351.jpg" alt="image-20181115182725221"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker tag  5fc4ede68fcd ccr.ccs.tencentyun.com/freemana2017/atcrod:latest</span><br><span class="line">$ sudo docker push ccr.ccs.tencentyun.com/freemana2017/atcrod:latest</span><br></pre></td></tr></table></figure>
<p>密码输入 z 因为是sudo</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022352.jpg" alt="image-20181115183150585"></p>
<h3 id="使用镜像—-下载镜像"><a href="#使用镜像—-下载镜像" class="headerlink" title="使用镜像—-下载镜像"></a>使用镜像—-下载镜像</h3><blockquote>
<p>小D课堂 第62讲 mac远程登陆腾讯云服务器 然后在腾讯云服务器上使用push命令拉去镜像 然后使用run命令运行镜像 最后改成公网访问镜像 </p>
</blockquote>
<blockquote>
<p>登陆到腾讯云的实验室 安装Docker环境 在本机上登陆SSH 然后搭建Docker环境</p>
</blockquote>
<h2 id="https-cloud-tencent-com-developer-labs-lab-10054-console"><a href="#https-cloud-tencent-com-developer-labs-lab-10054-console" class="headerlink" title="### https://cloud.tencent.com/developer/labs/lab/10054/console"></a>### <a href="https://cloud.tencent.com/developer/labs/lab/10054/console" target="_blank" rel="noopener">https://cloud.tencent.com/developer/labs/lab/10054/console</a></h2><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022354.jpg" alt="image-20181115185616768"></p>
<p>在本机上远程腾讯云 搭建Docker环境</p>
<p>登录到镜像仓库，需输入密码。</p>
<ul>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker login --username=[username] ccr.ccs.tencentyun.com</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>下载镜像。</p>
<ul>
<li>sudo docker pull ccr.ccs.tencentyun.com/freemana2017/atcrod:latest</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker pull ccr.ccs.tencentyun.com/freemana2017/atcrod:latest</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="⭐️Docker：Cannot-connect-to-the-Docker-daemon-Is-the-docker-daemon-running-on-this-host"><a href="#⭐️Docker：Cannot-connect-to-the-Docker-daemon-Is-the-docker-daemon-running-on-this-host" class="headerlink" title="⭐️Docker：Cannot connect to the Docker daemon. Is the docker daemon running on this host?"></a>⭐️Docker：Cannot connect to the Docker daemon. Is the docker daemon running on this host?</h1><blockquote>
<p> <a href="https://www.w3cschool.cn/kxqhmy/suzagdn1.html" target="_blank" rel="noopener">https://www.w3cschool.cn/kxqhmy/suzagdn1.html</a></p>
</blockquote>
<p>查看是否存在进程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ps aux |grep docker1</span><br></pre></td></tr></table></figure>
<p>停止进程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sudo service docker stop1</span><br></pre></td></tr></table></figure>
<p>重启docker：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$dockerd</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<hr>
<hr>
<h1 id="Docker在云服务器上的安装"><a href="#Docker在云服务器上的安装" class="headerlink" title="Docker在云服务器上的安装"></a>Docker在云服务器上的安装</h1><blockquote>
<p><a href="https://www.jianshu.com/p/ea3078dae4fb" target="_blank" rel="noopener">https://www.jianshu.com/p/ea3078dae4fb</a> 简书 </p>
</blockquote>
<p>1.登陆到服务器上面 通过终端 </p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-22358.jpg" alt="image-20181117182934398"></p>
<p>或者云主机登陆</p>
<p>2.开始操作</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022400.jpg" alt="image-20181117183003800"></p>
<p>3.<a href="https://docs.docker.com/install/linux/docker-ce/centos/#uninstall-old-versions" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/centos/#uninstall-old-versions</a> 官网</p>
<blockquote>
<p> Docker的安装方式—腾讯云服务器上面 好像买的系统是Cents的 安装 CentOS 的安装</p>
</blockquote>
<p>Docker：Cannot connect to the Docker daemon. Is the docker daemon running on this host? </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Docker：Cannot connect to the Docker daemon. Is the docker daemon running on this host?</span><br></pre></td></tr></table></figure>
<p>docker -d -p 8888：8080 </p>
<p>先分配角色。在启动Docker </p>
<p>如果端口播被占用了 先关闭Docker</p>
<p>sudo service docker stop</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service docker stop</span><br></pre></td></tr></table></figure>
<p>在启动Doccur</p>
<p>service docker start</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker start</span><br></pre></td></tr></table></figure>
<hr>
<p>大佬指教。不是locaohostg 192.168.2.123</p>
<p>是公网ip腾讯公网的ip–118.89.28.213</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022401.jpg" alt="image-20181118104713199"></p>
<p>加镜像名啊 兄die</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/11/Spring Boot/SpringBoot高级雷丰阳/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/11/Spring Boot/SpringBoot高级雷丰阳/" itemprop="url">SpringBoot  雷丰阳整合篇</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-11T10:13:42+08:00">
                2018-11-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/11/Spring Boot/SpringBoot高级雷丰阳/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/11/Spring Boot/SpringBoot高级雷丰阳/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#1 SpringBoot-cache</p>
<h4 id="SpringbootCacheApplication"><a href="#SpringbootCacheApplication" class="headerlink" title="SpringbootCacheApplication"></a>SpringbootCacheApplication</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.EnableCaching;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 一、搭建基本环境</span></span><br><span class="line"><span class="comment"> * 1、导入数据库文件 创建出department和employee表</span></span><br><span class="line"><span class="comment"> * 2、创建javaBean封装数据</span></span><br><span class="line"><span class="comment"> * 3、整合MyBatis操作数据库</span></span><br><span class="line"><span class="comment"> * 		1.配置数据源信息</span></span><br><span class="line"><span class="comment"> * 		2.使用注解版的MyBatis；</span></span><br><span class="line"><span class="comment"> * 			1）、<span class="doctag">@MapperScan</span>指定需要扫描的mapper接口所在的包</span></span><br><span class="line"><span class="comment"> * 二、快速体验缓存</span></span><br><span class="line"><span class="comment"> * 		步骤：</span></span><br><span class="line"><span class="comment"> * 			1、开启基于注解的缓存 <span class="doctag">@EnableCaching</span></span></span><br><span class="line"><span class="comment"> * 			2、标注缓存注解即可</span></span><br><span class="line"><span class="comment"> * 				<span class="doctag">@Cacheable</span></span></span><br><span class="line"><span class="comment"> * 				<span class="doctag">@CacheEvict</span></span></span><br><span class="line"><span class="comment"> * 				<span class="doctag">@CachePut</span></span></span><br><span class="line"><span class="comment"> * 默认使用的是ConcurrentMapCacheManager==ConcurrentMapCache；将数据保存在	ConcurrentMap&lt;Object, Object&gt;中</span></span><br><span class="line"><span class="comment"> * 开发中使用缓存中间件；redis、memcached、ehcache；</span></span><br><span class="line"><span class="comment"> * 三、整合redis作为缓存</span></span><br><span class="line"><span class="comment"> * Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件。</span></span><br><span class="line"><span class="comment"> * 	1、安装redis：使用docker；</span></span><br><span class="line"><span class="comment"> * 	2、引入redis的starter</span></span><br><span class="line"><span class="comment"> * 	3、配置redis</span></span><br><span class="line"><span class="comment"> * 	4、测试缓存</span></span><br><span class="line"><span class="comment"> * 		原理：CacheManager===Cache 缓存组件来实际给缓存中存取数据</span></span><br><span class="line"><span class="comment"> *		1）、引入redis的starter，容器中保存的是 RedisCacheManager；</span></span><br><span class="line"><span class="comment"> *		2）、RedisCacheManager 帮我们创建 RedisCache 来作为缓存组件；RedisCache通过操作redis缓存数据的</span></span><br><span class="line"><span class="comment"> *		3）、默认保存数据 k-v 都是Object；利用序列化保存；如何保存为json</span></span><br><span class="line"><span class="comment"> *   			1、引入了redis的starter，cacheManager变为 RedisCacheManager；</span></span><br><span class="line"><span class="comment"> *   			2、默认创建的 RedisCacheManager 操作redis的时候使用的是 RedisTemplate&lt;Object, Object&gt;</span></span><br><span class="line"><span class="comment"> *   			3、RedisTemplate&lt;Object, Object&gt; 是 默认使用jdk的序列化机制</span></span><br><span class="line"><span class="comment"> *      4）、自定义CacheManager；</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.atguigu.cache.mapper"</span>)</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Springboot01CacheApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(Springboot01CacheApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Bean–Department"><a href="#Bean–Department" class="headerlink" title="Bean–Department"></a>Bean–Department</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.cache.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Department</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String departmentName;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Department</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Department</span><span class="params">(Integer id, String departmentName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">		<span class="keyword">this</span>.departmentName = departmentName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDepartmentName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> departmentName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDepartmentName</span><span class="params">(String departmentName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.departmentName = departmentName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Department [id="</span> + id + <span class="string">", departmentName="</span> + departmentName + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Bean—Employee"><a href="#Bean—Employee" class="headerlink" title="Bean—Employee"></a>Bean—Employee</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.cache.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String lastName;</span><br><span class="line">	<span class="keyword">private</span> String email;</span><br><span class="line">	<span class="keyword">private</span> Integer gender; <span class="comment">//性别 1男  0女</span></span><br><span class="line">	<span class="keyword">private</span> Integer dId;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(Integer id, String lastName, String email, Integer gender, Integer dId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">		<span class="keyword">this</span>.gender = gender;</span><br><span class="line">		<span class="keyword">this</span>.dId = dId;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lastName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> gender;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(Integer gender)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.gender = gender;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getdId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> dId;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setdId</span><span class="params">(Integer dId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.dId = dId;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Employee [id="</span> + id + <span class="string">", lastName="</span> + lastName + <span class="string">", email="</span> + email + <span class="string">", gender="</span> + gender + <span class="string">", dId="</span></span><br><span class="line">				+ dId + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="config—myRedisConfig"><a href="#config—myRedisConfig" class="headerlink" title="config—myRedisConfig"></a>config—myRedisConfig</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.cache.config;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.cache.bean.Department;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.cache.bean.Employee;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Primary;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.cache.RedisCacheManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRedisConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object, Employee&gt; <span class="title">empRedisTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            RedisConnectionFactory redisConnectionFactory)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">        RedisTemplate&lt;Object, Employee&gt; template = <span class="keyword">new</span> RedisTemplate&lt;Object, Employee&gt;();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        Jackson2JsonRedisSerializer&lt;Employee&gt; ser = <span class="keyword">new</span> Jackson2JsonRedisSerializer&lt;Employee&gt;(Employee.class);</span><br><span class="line">        template.setDefaultSerializer(ser);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object, Department&gt; <span class="title">deptRedisTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            RedisConnectionFactory redisConnectionFactory)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">        RedisTemplate&lt;Object, Department&gt; template = <span class="keyword">new</span> RedisTemplate&lt;Object, Department&gt;();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        Jackson2JsonRedisSerializer&lt;Department&gt; ser = <span class="keyword">new</span> Jackson2JsonRedisSerializer&lt;Department&gt;(Department.class);</span><br><span class="line">        template.setDefaultSerializer(ser);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//CacheManagerCustomizers可以来定制缓存的一些规则</span></span><br><span class="line">    <span class="meta">@Primary</span>  <span class="comment">//将某个缓存管理器作为默认的</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisCacheManager <span class="title">employeeCacheManager</span><span class="params">(RedisTemplate&lt;Object, Employee&gt; empRedisTemplate)</span></span>&#123;</span><br><span class="line">        RedisCacheManager cacheManager = <span class="keyword">new</span> RedisCacheManager(empRedisTemplate);</span><br><span class="line">        <span class="comment">//key多了一个前缀</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用前缀，默认会将CacheName作为key的前缀</span></span><br><span class="line">        cacheManager.setUsePrefix(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cacheManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisCacheManager <span class="title">deptCacheManager</span><span class="params">(RedisTemplate&lt;Object, Department&gt; deptRedisTemplate)</span></span>&#123;</span><br><span class="line">        RedisCacheManager cacheManager = <span class="keyword">new</span> RedisCacheManager(deptRedisTemplate);</span><br><span class="line">        <span class="comment">//key多了一个前缀</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用前缀，默认会将CacheName作为key的前缀</span></span><br><span class="line">        cacheManager.setUsePrefix(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cacheManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="config—mycacheconfig"><a href="#config—mycacheconfig" class="headerlink" title="config—mycacheconfig"></a>config—mycacheconfig</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package com.atguigu.cache.config;</span><br><span class="line"></span><br><span class="line">import org.springframework.cache.interceptor.KeyGenerator;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">import java.util.Arrays;</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">public class MyCacheConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Bean(&quot;myKeyGenerator&quot;)</span><br><span class="line">    public KeyGenerator keyGenerator()&#123;</span><br><span class="line">        return new KeyGenerator()&#123;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public Object generate(Object target, Method method, Object... params) &#123;</span><br><span class="line">                return method.getName()+&quot;[&quot;+ Arrays.asList(params).toString()+&quot;]&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="DeptService"><a href="#DeptService" class="headerlink" title="DeptService"></a>DeptService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.cache.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.cache.bean.Department;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.cache.mapper.DepartmentMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.Cache;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CacheConfig;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.Cacheable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.cache.RedisCacheManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeptService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DepartmentMapper departmentMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Qualifier</span>(<span class="string">"deptCacheManager"</span>)</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RedisCacheManager deptCacheManager;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  缓存的数据能存入redis；</span></span><br><span class="line"><span class="comment">     *  第二次从缓存中查询就不能反序列化回来；</span></span><br><span class="line"><span class="comment">     *  存的是dept的json数据;CacheManager默认使用RedisTemplate&lt;Object, Employee&gt;操作Redis</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="comment">//    @Cacheable(cacheNames = "dept",cacheManager = "deptCacheManager")</span></span><br><span class="line"><span class="comment">//    public Department getDeptById(Integer id)&#123;</span></span><br><span class="line"><span class="comment">//        System.out.println("查询部门"+id);</span></span><br><span class="line"><span class="comment">//        Department department = departmentMapper.getDeptById(id);</span></span><br><span class="line"><span class="comment">//        return department;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用缓存管理器得到缓存，进行api调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Department <span class="title">getDeptById</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"查询部门"</span>+id);</span><br><span class="line">        Department department = departmentMapper.getDeptById(id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取某个缓存</span></span><br><span class="line">        Cache dept = deptCacheManager.getCache(<span class="string">"dept"</span>);</span><br><span class="line">        dept.put(<span class="string">"dept:1"</span>,department);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> department;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="EmployeeService"><a href="#EmployeeService" class="headerlink" title="EmployeeService"></a>EmployeeService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.cache.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.cache.bean.Employee;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.cache.mapper.EmployeeMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@CacheConfig</span>(cacheNames=<span class="string">"emp"</span><span class="comment">/*,cacheManager = "employeeCacheManager"*/</span>) <span class="comment">//抽取缓存的公共配置</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将方法的运行结果进行缓存；以后再要相同的数据，直接从缓存中获取，不用调用方法；</span></span><br><span class="line"><span class="comment">     * CacheManager管理多个Cache组件的，对缓存的真正CRUD操作在Cache组件中，每一个缓存组件有自己唯一一个名字；</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 原理：</span></span><br><span class="line"><span class="comment">     *   1、自动配置类；CacheAutoConfiguration</span></span><br><span class="line"><span class="comment">     *   2、缓存的配置类</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.GenericCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.JCacheCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.EhCacheCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.HazelcastCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.InfinispanCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.CouchbaseCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.RedisCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.CaffeineCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.GuavaCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.SimpleCacheConfiguration【默认】</span></span><br><span class="line"><span class="comment">     *   org.springframework.boot.autoconfigure.cache.NoOpCacheConfiguration</span></span><br><span class="line"><span class="comment">     *   3、哪个配置类默认生效：SimpleCacheConfiguration；</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *   4、给容器中注册了一个CacheManager：ConcurrentMapCacheManager</span></span><br><span class="line"><span class="comment">     *   5、可以获取和创建ConcurrentMapCache类型的缓存组件；他的作用将数据保存在ConcurrentMap中；</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *   运行流程：</span></span><br><span class="line"><span class="comment">     *   <span class="doctag">@Cacheable</span>：</span></span><br><span class="line"><span class="comment">     *   1、方法运行之前，先去查询Cache（缓存组件），按照cacheNames指定的名字获取；</span></span><br><span class="line"><span class="comment">     *      （CacheManager先获取相应的缓存），第一次获取缓存如果没有Cache组件会自动创建。</span></span><br><span class="line"><span class="comment">     *   2、去Cache中查找缓存的内容，使用一个key，默认就是方法的参数；</span></span><br><span class="line"><span class="comment">     *      key是按照某种策略生成的；默认是使用keyGenerator生成的，默认使用SimpleKeyGenerator生成key；</span></span><br><span class="line"><span class="comment">     *          SimpleKeyGenerator生成key的默认策略；</span></span><br><span class="line"><span class="comment">     *                  如果没有参数；key=new SimpleKey()；</span></span><br><span class="line"><span class="comment">     *                  如果有一个参数：key=参数的值</span></span><br><span class="line"><span class="comment">     *                  如果有多个参数：key=new SimpleKey(params)；</span></span><br><span class="line"><span class="comment">     *   3、没有查到缓存就调用目标方法；</span></span><br><span class="line"><span class="comment">     *   4、将目标方法返回的结果，放进缓存中</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *   <span class="doctag">@Cacheable</span>标注的方法执行之前先来检查缓存中有没有这个数据，默认按照参数的值作为key去查询缓存，</span></span><br><span class="line"><span class="comment">     *   如果没有就运行方法并将结果放入缓存；以后再来调用就可以直接使用缓存中的数据；</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *   核心：</span></span><br><span class="line"><span class="comment">     *      1）、使用CacheManager【ConcurrentMapCacheManager】按照名字得到Cache【ConcurrentMapCache】组件</span></span><br><span class="line"><span class="comment">     *      2）、key使用keyGenerator生成的，默认是SimpleKeyGenerator</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *   几个属性：</span></span><br><span class="line"><span class="comment">     *      cacheNames/value：指定缓存组件的名字;将方法的返回结果放在哪个缓存中，是数组的方式，可以指定多个缓存；</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      key：缓存数据使用的key；可以用它来指定。默认是使用方法参数的值  1-方法的返回值</span></span><br><span class="line"><span class="comment">     *              编写SpEL； #i d;参数id的值   #a0  #p0  #root.args[0]</span></span><br><span class="line"><span class="comment">     *              getEmp[2]</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      keyGenerator：key的生成器；可以自己指定key的生成器的组件id</span></span><br><span class="line"><span class="comment">     *              key/keyGenerator：二选一使用;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      cacheManager：指定缓存管理器；或者cacheResolver指定获取解析器</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      condition：指定符合条件的情况下才缓存；</span></span><br><span class="line"><span class="comment">     *              ,condition = "#id&gt;0"</span></span><br><span class="line"><span class="comment">     *          condition = "#a0&gt;1"：第一个参数的值》1的时候才进行缓存</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      unless:否定缓存；当unless指定的条件为true，方法的返回值就不会被缓存；可以获取到结果进行判断</span></span><br><span class="line"><span class="comment">     *              unless = "#result == null"</span></span><br><span class="line"><span class="comment">     *              unless = "#a0==2":如果第一个参数的值是2，结果不缓存；</span></span><br><span class="line"><span class="comment">     *      sync：是否使用异步模式</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Cacheable</span>(value = &#123;<span class="string">"emp"</span>&#125;<span class="comment">/*,keyGenerator = "myKeyGenerator",condition = "#a0&gt;1",unless = "#a0==2"*/</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmp</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"查询"</span>+id+<span class="string">"号员工"</span>);</span><br><span class="line">        Employee emp = employeeMapper.getEmpById(id);</span><br><span class="line">        <span class="keyword">return</span> emp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@CachePut</span>：既调用方法，又更新缓存数据；同步更新缓存</span></span><br><span class="line"><span class="comment">     * 修改了数据库的某个数据，同时更新缓存；</span></span><br><span class="line"><span class="comment">     * 运行时机：</span></span><br><span class="line"><span class="comment">     *  1、先调用目标方法</span></span><br><span class="line"><span class="comment">     *  2、将目标方法的结果缓存起来</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 测试步骤：</span></span><br><span class="line"><span class="comment">     *  1、查询1号员工；查到的结果会放在缓存中；</span></span><br><span class="line"><span class="comment">     *          key：1  value：lastName：张三</span></span><br><span class="line"><span class="comment">     *  2、以后查询还是之前的结果</span></span><br><span class="line"><span class="comment">     *  3、更新1号员工；【lastName:zhangsan；gender:0】</span></span><br><span class="line"><span class="comment">     *          将方法的返回值也放进缓存了；</span></span><br><span class="line"><span class="comment">     *          key：传入的employee对象  值：返回的employee对象；</span></span><br><span class="line"><span class="comment">     *  4、查询1号员工？</span></span><br><span class="line"><span class="comment">     *      应该是更新后的员工；</span></span><br><span class="line"><span class="comment">     *          key = "#employee.id":使用传入的参数的员工id；</span></span><br><span class="line"><span class="comment">     *          key = "#result.id"：使用返回后的id</span></span><br><span class="line"><span class="comment">     *             <span class="doctag">@Cacheable</span>的key是不能用#result</span></span><br><span class="line"><span class="comment">     *      为什么是没更新前的？【1号员工没有在缓存中更新】</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@CachePut</span>(<span class="comment">/*value = "emp",*/</span>key = <span class="string">"#result.id"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">updateEmp</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"updateEmp:"</span>+employee);</span><br><span class="line">        employeeMapper.updateEmp(employee);</span><br><span class="line">        <span class="keyword">return</span> employee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@CacheEvict</span>：缓存清除</span></span><br><span class="line"><span class="comment">     *  key：指定要清除的数据</span></span><br><span class="line"><span class="comment">     *  allEntries = true：指定清除这个缓存中所有的数据</span></span><br><span class="line"><span class="comment">     *  beforeInvocation = false：缓存的清除是否在方法之前执行</span></span><br><span class="line"><span class="comment">     *      默认代表缓存清除操作是在方法执行之后执行;如果出现异常缓存就不会清除</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  beforeInvocation = true：</span></span><br><span class="line"><span class="comment">     *      代表清除缓存操作是在方法运行之前执行，无论方法是否出现异常，缓存都清除</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@CacheEvict</span>(value=<span class="string">"emp"</span>,beforeInvocation = <span class="keyword">true</span><span class="comment">/*key = "#id",*/</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteEmp</span><span class="params">(Integer id)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"deleteEmp:"</span>+id);</span><br><span class="line">        <span class="comment">//employeeMapper.deleteEmpById(id);</span></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @Caching 定义复杂的缓存规则</span></span><br><span class="line">    <span class="meta">@Caching</span>(</span><br><span class="line">         cacheable = &#123;</span><br><span class="line">             <span class="meta">@Cacheable</span>(<span class="comment">/*value="emp",*/</span>key = <span class="string">"#lastName"</span>)</span><br><span class="line">         &#125;,</span><br><span class="line">         put = &#123;</span><br><span class="line">             <span class="meta">@CachePut</span>(<span class="comment">/*value="emp",*/</span>key = <span class="string">"#result.id"</span>),</span><br><span class="line">             <span class="meta">@CachePut</span>(<span class="comment">/*value="emp",*/</span>key = <span class="string">"#result.email"</span>)</span><br><span class="line">         &#125;</span><br><span class="line">    )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmpByLastName</span><span class="params">(String lastName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> employeeMapper.getEmpByLastName(lastName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-SpringBoot-amqp"><a href="#2-SpringBoot-amqp" class="headerlink" title="2 SpringBoot -amqp"></a>2 SpringBoot -amqp</h1><h4 id="SpringBootAmqpApplication"><a href="#SpringBootAmqpApplication" class="headerlink" title="SpringBootAmqpApplication"></a>SpringBootAmqpApplication</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.amqp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.EnableRabbit;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自动配置</span></span><br><span class="line"><span class="comment"> *  1、RabbitAutoConfiguration</span></span><br><span class="line"><span class="comment"> *  2、有自动配置了连接工厂ConnectionFactory；</span></span><br><span class="line"><span class="comment"> *  3、RabbitProperties 封装了 RabbitMQ的配置</span></span><br><span class="line"><span class="comment"> *  4、 RabbitTemplate ：给RabbitMQ发送和接受消息；</span></span><br><span class="line"><span class="comment"> *  5、 AmqpAdmin ： RabbitMQ系统管理功能组件;</span></span><br><span class="line"><span class="comment"> *  	AmqpAdmin：创建和删除 Queue，Exchange，Binding</span></span><br><span class="line"><span class="comment"> *  6、<span class="doctag">@EnableRabbit</span> +  <span class="doctag">@RabbitListener</span> 监听消息队列的内容</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EnableRabbit</span>  <span class="comment">//开启基于注解的RabbitMQ模式</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Springboot02AmqpApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(Springboot02AmqpApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="BookService"><a href="#BookService" class="headerlink" title="BookService"></a>BookService</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.amqp.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.amqp.bean.Book;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener</span>(queues = <span class="string">"atguigu.news"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(Book book)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"收到消息："</span>+book);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener</span>(queues = <span class="string">"atguigu"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive02</span><span class="params">(Message message)</span></span>&#123;</span><br><span class="line">        System.out.println(message.getBody());</span><br><span class="line">        System.out.println(message.getMessageProperties());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="MyAMQPConfig"><a href="#MyAMQPConfig" class="headerlink" title="MyAMQPConfig"></a>MyAMQPConfig</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class MyAMQPConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public MessageConverter messageConverter()&#123;</span><br><span class="line">        return new Jackson2JsonMessageConverter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-SpringBoot-elastic"><a href="#3-SpringBoot-elastic" class="headerlink" title="3 SpringBoot-elastic"></a>3 SpringBoot-elastic</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.elastic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SpringBoot默认支持两种技术来和ES交互；</span></span><br><span class="line"><span class="comment"> * 1、Jest（默认不生效）</span></span><br><span class="line"><span class="comment"> * 	需要导入jest的工具包（io.searchbox.client.JestClient）</span></span><br><span class="line"><span class="comment"> * 2、SpringData ElasticSearch【ES版本有可能不合适】</span></span><br><span class="line"><span class="comment"> * 		版本适配说明：https://github.com/spring-projects/spring-data-elasticsearch</span></span><br><span class="line"><span class="comment"> *		如果版本不适配：2.4.6</span></span><br><span class="line"><span class="comment"> *			1）、升级SpringBoot版本</span></span><br><span class="line"><span class="comment"> *			2）、安装对应版本的ES</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 		1）、Client 节点信息clusterNodes；clusterName</span></span><br><span class="line"><span class="comment"> * 		2）、ElasticsearchTemplate 操作es</span></span><br><span class="line"><span class="comment"> *		3）、编写一个 ElasticsearchRepository 的子接口来操作ES；</span></span><br><span class="line"><span class="comment"> *	两种用法：https://github.com/spring-projects/spring-data-elasticsearch</span></span><br><span class="line"><span class="comment"> *	1）、编写一个 ElasticsearchRepository</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Springboot03ElasticApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(Springboot03ElasticApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="BookRepository"><a href="#BookRepository" class="headerlink" title="BookRepository"></a>BookRepository</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.elastic.repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.elastic.bean.Book;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.elasticsearch.repository.ElasticsearchRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookRepository</span> <span class="keyword">extends</span> <span class="title">ElasticsearchRepository</span>&lt;<span class="title">Book</span>,<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//参照</span></span><br><span class="line">    <span class="comment">// https://docs.spring.io/spring-data/elasticsearch/docs/3.0.6.RELEASE/reference/html/</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">findByBookNameLike</span><span class="params">(String bookName)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Book"><a href="#Book" class="headerlink" title="Book"></a>Book</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Document</span>(indexName = <span class="string">"atguigu"</span>,type = <span class="string">"book"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String bookName;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="properties"><a href="#properties" class="headerlink" title="properties"></a>properties</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.elasticsearch.jest.uris=http:<span class="comment">//118.24.44.169:9200</span></span><br><span class="line"></span><br><span class="line">spring.data.elasticsearch.cluster-name=elasticsearch</span><br><span class="line">spring.data.elasticsearch.cluster-nodes=<span class="number">118.24</span>.44.169:<span class="number">9301</span></span><br></pre></td></tr></table></figure>
<h1 id="4-SpringBoot-task"><a href="#4-SpringBoot-task" class="headerlink" title="4 SpringBoot -task"></a>4 SpringBoot -task</h1><h4 id="SpringBoot-TaskApplication"><a href="#SpringBoot-TaskApplication" class="headerlink" title="SpringBoot-TaskApplication"></a>SpringBoot-TaskApplication</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.task;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.EnableAsync;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.EnableScheduling;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableAsync</span>  <span class="comment">//开启异步注解功能</span></span><br><span class="line"><span class="meta">@EnableScheduling</span> <span class="comment">//开启基于注解的定时任务</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Springboot04TaskApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(Springboot04TaskApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="AsyncService"><a href="#AsyncService" class="headerlink" title="AsyncService"></a>AsyncService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.task.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Async;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//告诉Spring这是一个异步方法</span></span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"处理数据中..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ScheduleService"><a href="#ScheduleService" class="headerlink" title="ScheduleService"></a>ScheduleService</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.task.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScheduledService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * second(秒), minute（分）, hour（时）, day of month（日）, month（月）, day of week（周几）.</span></span><br><span class="line"><span class="comment">     * 0 * * * * MON-FRI</span></span><br><span class="line"><span class="comment">     *  【0 0/5 14,18 * * ?】 每天14点整，和18点整，每隔5分钟执行一次</span></span><br><span class="line"><span class="comment">     *  【0 15 10 ? * 1-6】 每个月的周一至周六10:15分执行一次</span></span><br><span class="line"><span class="comment">     *  【0 0 2 ? * 6L】每个月的最后一个周六凌晨2点执行一次</span></span><br><span class="line"><span class="comment">     *  【0 0 2 LW * ?】每个月的最后一个工作日凌晨2点执行一次</span></span><br><span class="line"><span class="comment">     *  【0 0 2-4 ? * 1#1】每个月的第一个周一凌晨2点到4点期间，每个整点都执行一次；</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">   <span class="comment">// @Scheduled(cron = "0 * * * * MON-SAT")</span></span><br><span class="line">    <span class="comment">//@Scheduled(cron = "0,1,2,3,4 * * * * MON-SAT")</span></span><br><span class="line">   <span class="comment">// @Scheduled(cron = "0-4 * * * * MON-SAT")</span></span><br><span class="line">    <span class="meta">@Scheduled</span>(cron = <span class="string">"0/4 * * * * MON-SAT"</span>)  <span class="comment">//每4秒执行一次</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"hello ... "</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Asyncontroller"><a href="#Asyncontroller" class="headerlink" title="Asyncontroller"></a>Asyncontroller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.task.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.task.service.AsyncService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    AsyncService asyncService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        asyncService.hello();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="properties-1"><a href="#properties-1" class="headerlink" title="properties"></a>properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.mail.username=534096094@qq.com</span><br><span class="line">spring.mail.password=gtstkoszjelabijb</span><br><span class="line">spring.mail.host=smtp.qq.com</span><br><span class="line">spring.mail.properties.mail.smtp.ssl.enable=true</span><br></pre></td></tr></table></figure>
<h1 id="5-Spring-security"><a href="#5-Spring-security" class="headerlink" title="5 Spring-security"></a>5 Spring-security</h1><h4 id="SpringBootSecurityApplication"><a href="#SpringBootSecurityApplication" class="headerlink" title="SpringBootSecurityApplication"></a>SpringBootSecurityApplication</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1、引入SpringSecurity；</span></span><br><span class="line"><span class="comment"> * 2、编写SpringSecurity的配置类；</span></span><br><span class="line"><span class="comment"> * 		<span class="doctag">@EnableWebSecurity</span>   extends WebSecurityConfigurerAdapter</span></span><br><span class="line"><span class="comment"> * 3、控制请求的访问权限：</span></span><br><span class="line"><span class="comment"> * 		configure(HttpSecurity http) &#123;</span></span><br><span class="line"><span class="comment"> * 		 	http.authorizeRequests().antMatchers("/").permitAll()</span></span><br><span class="line"><span class="comment"> * 		 		.antMatchers("/level1/**").hasRole("VIP1")</span></span><br><span class="line"><span class="comment"> * 		&#125;</span></span><br><span class="line"><span class="comment"> * 4、定义认证规则：</span></span><br><span class="line"><span class="comment"> * 		configure(AuthenticationManagerBuilder auth)&#123;</span></span><br><span class="line"><span class="comment"> * 		 	auth.inMemoryAuthentication()</span></span><br><span class="line"><span class="comment"> * 		 		.withUser("zhangsan").password("123456").roles("VIP1","VIP2")</span></span><br><span class="line"><span class="comment"> * 		&#125;</span></span><br><span class="line"><span class="comment"> * 5、开启自动配置的登陆功能：</span></span><br><span class="line"><span class="comment"> * 		configure(HttpSecurity http)&#123;</span></span><br><span class="line"><span class="comment"> * 		 	http.formLogin();</span></span><br><span class="line"><span class="comment"> * 		&#125;</span></span><br><span class="line"><span class="comment"> * 6、注销：http.logout();</span></span><br><span class="line"><span class="comment"> * 7、记住我：Remeberme()；</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Springboot05SecurityApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(Springboot05SecurityApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="MySecurityConfig"><a href="#MySecurityConfig" class="headerlink" title="MySecurityConfig"></a>MySecurityConfig</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.security.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableWebSecurity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//super.configure(http);</span></span><br><span class="line">        <span class="comment">//定制请求的授权规则</span></span><br><span class="line">        http.authorizeRequests().antMatchers(<span class="string">"/"</span>).permitAll()</span><br><span class="line">                .antMatchers(<span class="string">"/level1/**"</span>).hasRole(<span class="string">"VIP1"</span>)</span><br><span class="line">                .antMatchers(<span class="string">"/level2/**"</span>).hasRole(<span class="string">"VIP2"</span>)</span><br><span class="line">                .antMatchers(<span class="string">"/level3/**"</span>).hasRole(<span class="string">"VIP3"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//开启自动配置的登陆功能，效果，如果没有登陆，没有权限就会来到登陆页面</span></span><br><span class="line">        http.formLogin().usernameParameter(<span class="string">"user"</span>).passwordParameter(<span class="string">"pwd"</span>)</span><br><span class="line">                .loginPage(<span class="string">"/userlogin"</span>);</span><br><span class="line">        <span class="comment">//1、/login来到登陆页</span></span><br><span class="line">        <span class="comment">//2、重定向到/login?error表示登陆失败</span></span><br><span class="line">        <span class="comment">//3、更多详细规定</span></span><br><span class="line">        <span class="comment">//4、默认post形式的 /login代表处理登陆</span></span><br><span class="line">        <span class="comment">//5、一但定制loginPage；那么 loginPage的post请求就是登陆</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//开启自动配置的注销功能。</span></span><br><span class="line">        http.logout().logoutSuccessUrl(<span class="string">"/"</span>);<span class="comment">//注销成功以后来到首页</span></span><br><span class="line">        <span class="comment">//1、访问 /logout 表示用户注销，清空session</span></span><br><span class="line">        <span class="comment">//2、注销成功会返回 /login?logout 页面；</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//开启记住我功能</span></span><br><span class="line">        http.rememberMe().rememberMeParameter(<span class="string">"remeber"</span>);</span><br><span class="line">        <span class="comment">//登陆成功以后，将cookie发给浏览器保存，以后访问页面带上这个cookie，只要通过检查就可以免登录</span></span><br><span class="line">        <span class="comment">//点击注销会删除cookie</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义认证规则</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//super.configure(auth);</span></span><br><span class="line">        auth.inMemoryAuthentication()</span><br><span class="line">                .withUser(<span class="string">"zhangsan"</span>).password(<span class="string">"123456"</span>).roles(<span class="string">"VIP1"</span>,<span class="string">"VIP2"</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">"lisi"</span>).password(<span class="string">"123456"</span>).roles(<span class="string">"VIP2"</span>,<span class="string">"VIP3"</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">"wangwu"</span>).password(<span class="string">"123456"</span>).roles(<span class="string">"VIP1"</span>,<span class="string">"VIP3"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.security.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KungfuController</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> String PREFIX = <span class="string">"pages/"</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 欢迎页</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"welcome"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 登陆页</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/userlogin"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">loginPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> PREFIX+<span class="string">"login"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * level1页面映射</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> path</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/level1/&#123;path&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">level1</span><span class="params">(@PathVariable(<span class="string">"path"</span>)</span>String path) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> PREFIX+<span class="string">"level1/"</span>+path;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * level2页面映射</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> path</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/level2/&#123;path&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">level2</span><span class="params">(@PathVariable(<span class="string">"path"</span>)</span>String path) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> PREFIX+<span class="string">"level2/"</span>+path;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * level3页面映射</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> path</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@GetMapping</span>(<span class="string">"/level3/&#123;path&#125;"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">level3</span><span class="params">(@PathVariable(<span class="string">"path"</span>)</span>String path) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> PREFIX+<span class="string">"level3/"</span>+path;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="welcome"><a href="#welcome" class="headerlink" title="welcome"></a>welcome</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span></span></span><br><span class="line"><span class="tag">	  <span class="attr">xmlns:sec</span>=<span class="string">"http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span>欢迎光临武林秘籍管理系统<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">sec:authorize</span>=<span class="string">"!isAuthenticated()"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span>游客您好，如果想查看武林秘籍 <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/userlogin&#125;"</span>&gt;</span>请登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">sec:authorize</span>=<span class="string">"isAuthenticated()"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">sec:authentication</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>，您好,您的角色有：</span><br><span class="line">		<span class="tag">&lt;<span class="name">span</span> <span class="attr">sec:authentication</span>=<span class="string">"principal.authorities"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">"@&#123;/logout&#125;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"注销"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">sec:authorize</span>=<span class="string">"hasRole('VIP1')"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h3</span>&gt;</span>普通武功秘籍<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level1/1&#125;"</span>&gt;</span>罗汉拳<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level1/2&#125;"</span>&gt;</span>武当长拳<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level1/3&#125;"</span>&gt;</span>全真剑法<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">sec:authorize</span>=<span class="string">"hasRole('VIP2')"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h3</span>&gt;</span>高级武功秘籍<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level2/1&#125;"</span>&gt;</span>太极拳<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level2/2&#125;"</span>&gt;</span>七伤拳<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level2/3&#125;"</span>&gt;</span>梯云纵<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">sec:authorize</span>=<span class="string">"hasRole('VIP3')"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h3</span>&gt;</span>绝世武功秘籍<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level3/1&#125;"</span>&gt;</span>葵花宝典<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level3/2&#125;"</span>&gt;</span>龟派气功<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/level3/3&#125;"</span>&gt;</span>独孤九剑<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="loginhtml"><a href="#loginhtml" class="headerlink" title="loginhtml"></a>loginhtml</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h1 align=&quot;center&quot;&gt;欢迎登陆武林秘籍管理系统&lt;/h1&gt;</span><br><span class="line">	&lt;hr&gt;</span><br><span class="line">	&lt;div align=&quot;center&quot;&gt;</span><br><span class="line">		&lt;form th:action=&quot;@&#123;/userlogin&#125;&quot; method=&quot;post&quot;&gt;</span><br><span class="line">			用户名:&lt;input name=&quot;user&quot;/&gt;&lt;br&gt;</span><br><span class="line">			密码:&lt;input name=&quot;pwd&quot;&gt;&lt;br/&gt;</span><br><span class="line">			&lt;input type=&quot;checkbox&quot; name=&quot;remeber&quot;&gt; 记住我&lt;br/&gt;</span><br><span class="line">			&lt;input type=&quot;submit&quot; value=&quot;登陆&quot;&gt;</span><br><span class="line">		&lt;/form&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h1 id="6-springboot-dubbo"><a href="#6-springboot-dubbo" class="headerlink" title="6  springboot-dubbo"></a>6  springboot-dubbo</h1><h4 id="consumer-user"><a href="#consumer-user" class="headerlink" title="consumer-user"></a>consumer-user</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Reference;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.ticket.service.TicketService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Reference</span></span><br><span class="line">    TicketService ticketService;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String ticket = ticketService.getTicket();</span><br><span class="line">        System.out.println(<span class="string">"买到票了："</span>+ticket);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="application-properties"><a href="#application-properties" class="headerlink" title="application.properties"></a>application.properties</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dubbo.application.name=consumer-user</span><br><span class="line"></span><br><span class="line">dubbo.registry.address=zookeeper:<span class="comment">//118.24.44.169:2181</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Service</span> <span class="comment">//将服务发布出去</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TicketServiceImpl</span> <span class="keyword">implements</span> <span class="title">TicketService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTicket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"《厉害了，我的国》"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dubbo.application.name=provider-ticket</span><br><span class="line"></span><br><span class="line">dubbo.registry.address=zookeeper://118.24.44.169:2181</span><br><span class="line"></span><br><span class="line">dubbo.scan.base-packages=com.atguigu.ticket.service</span><br></pre></td></tr></table></figure>
<h4 id="SpringCloud"><a href="#SpringCloud" class="headerlink" title="SpringCloud"></a>SpringCloud</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 注册中心</span><br><span class="line"> * 1、配置Eureka信息</span><br><span class="line"> * 2、@EnableEurekaServer</span><br><span class="line"> */</span><br><span class="line">@EnableEurekaServer</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class EurekaServerApplication &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		SpringApplication.run(EurekaServerApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: 8761</span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    hostname: eureka-server  # eureka实例的主机名</span><br><span class="line">  client:</span><br><span class="line">    register-with-eureka: false #不把自己注册到eureka上</span><br><span class="line">    fetch-registry: false #不从eureka上来获取服务的注册信息</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http://localhost:8761/eureka/</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: 8002</span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: provider-ticket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    prefer-ip-address: true # 注册服务的时候使用服务的ip地址</span><br><span class="line">  client:</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http://localhost:8761/eureka/</span><br></pre></td></tr></table></figure>
<h1 id="Springboot-Actuar"><a href="#Springboot-Actuar" class="headerlink" title="Springboot Actuar"></a>Springboot Actuar</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 自定义健康状态指示器</span><br><span class="line"> * 1、编写一个指示器 实现 HealthIndicator 接口</span><br><span class="line"> * 2、指示器的名字 xxxxHealthIndicator</span><br><span class="line"> * 3、加入容器中</span><br><span class="line"> */</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class Springboot08ActuatorApplication &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		SpringApplication.run(Springboot08ActuatorApplication.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package com.atguigu.springboot08actuator.health;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.actuate.health.Health;</span><br><span class="line">import org.springframework.boot.actuate.health.HealthIndicator;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">public class MyAppHealthIndicator implements HealthIndicator &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Health health() &#123;</span><br><span class="line"></span><br><span class="line">        //自定义的检查方法</span><br><span class="line">        //Health.up().build()代表健康</span><br><span class="line">        return Health.down().withDetail(&quot;msg&quot;,&quot;服务异常&quot;).build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git.branch=master</span><br><span class="line">git.commit.id=xjkd33s</span><br><span class="line">git.commit.time=2017-12-12 12:12:56</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">management.security.enabled=false</span><br><span class="line"></span><br><span class="line">spring.redis.host=118.24.44.169</span><br><span class="line"></span><br><span class="line">info.app.id=hello</span><br><span class="line">info.app.version=1.0.0</span><br><span class="line"></span><br><span class="line">#endpoints.metrics.enabled=false</span><br><span class="line">endpoints.shutdown.enabled=true</span><br><span class="line"></span><br><span class="line">#endpoints.beans.id=mybean</span><br><span class="line">#endpoints.beans.path=/bean</span><br><span class="line">#endpoints.beans.enabled=false</span><br><span class="line">#</span><br><span class="line">#endpoints.dump.path=/du</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># \u5173\u95ED\u6240\u6709\u7AEF\u70B9\u8BBF\u95EE</span><br><span class="line">#endpoints.enabled=false</span><br><span class="line">#endpoints.beans.enabled=true</span><br><span class="line"></span><br><span class="line">management.context-path=/manage</span><br><span class="line"></span><br><span class="line">management.port=8181</span><br></pre></td></tr></table></figure>
<p> 1</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/11/Spring Boot/SpringBoot-Docker-小D课堂/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/11/Spring Boot/SpringBoot-Docker-小D课堂/" itemprop="url">SpringBoot Docker 小D课堂</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-11T10:13:42+08:00">
                2018-11-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/11/Spring Boot/SpringBoot-Docker-小D课堂/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/11/Spring Boot/SpringBoot-Docker-小D课堂/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="构建SpringBoot-应用docker镜像"><a href="#构建SpringBoot-应用docker镜像" class="headerlink" title="构建SpringBoot 应用docker镜像"></a>构建SpringBoot 应用docker镜像</h1><h4 id="1-第1课-高级篇幅之构建SpringBoot应用docker镜像上集"><a href="#1-第1课-高级篇幅之构建SpringBoot应用docker镜像上集" class="headerlink" title="1.第1课 高级篇幅之构建SpringBoot应用docker镜像上集"></a>1.第1课 高级篇幅之构建SpringBoot应用docker镜像上集</h4><blockquote>
<p> 官方文档：<a href="https://spring.io/guides/gs/spring-boot-docker/" target="_blank" rel="noopener">https://spring.io/guides/gs/spring-boot-docker/</a></p>
<h2 id="1、步骤：maven里面添加配置pom-xml"><a href="#1、步骤：maven里面添加配置pom-xml" class="headerlink" title="1、步骤：maven里面添加配置pom.xml"></a>1、步骤：maven里面添加配置pom.xml</h2></blockquote>
<pre><code>简介:使用Docker的maven插件，构建springboot应用
 &lt;!--在maven最上面的申明的地方--properties--&gt;
     &lt;properties&gt;
       &lt;docker.image.prefix&gt;xdclass&lt;/docker.image.prefix&gt;
    &lt;/properties&gt;

    &lt;build&gt;
    &lt;!--项目打包的名称--&gt;
        &lt;finalName&gt;docker-demo&lt;/finalName&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;com.spotify&lt;/groupId&gt;
                &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;1.3.6&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;repository&gt;${docker.image.prefix}/${project.artifactId}&lt;/repository&gt;
                    &lt;buildArgs&gt;
                        &lt;JAR_FILE&gt;target/${project.build.finalName}.jar&lt;/JAR_FILE&gt;
                    &lt;/buildArgs&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    配置讲解
    Spotify 的 docker-maven-plugin 插件是用maven插件方式构建docker镜像的。
    ${project.build.finalName} 产出物名称，缺省为${project.artifactId}-${project.version}
</code></pre><p>⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️</p>
<blockquote>
<p> <a href="https://blog.csdn.net/TMaskBoy/article/details/82562413" target="_blank" rel="noopener">https://blog.csdn.net/TMaskBoy/article/details/82562413</a></p>
</blockquote>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-021717.jpg" alt="image-20181111112653319"></p>
<h1 id="高能预警"><a href="#高能预警" class="headerlink" title="高能预警"></a>高能预警</h1><ul>
<li><p>No plugin found for prefix ‘docker’ in the current project and in the plugin groups<br>在Maven的配置文件 conf/settings.xml中添加com.spotify</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;pluginGroups&gt;  </span><br><span class="line">    &lt;pluginGroup&gt;com.spotify&lt;/pluginGroup&gt;  </span><br><span class="line">&lt;/pluginGroups&gt;</span><br><span class="line"></span><br><span class="line">注意setting配置文件在maven的仓库里面找不到 重新更新idea中maven的插件 然后 更换.m2中conf中setting.xml的内容</span><br></pre></td></tr></table></figure>
</li>
<li><p>#详细错误如下：om.spotify.docker.client.shaded.com.fasterxml.jackson.databind.JsonMappingException: Can not construct instance of com.spotify.docker.client.messages.RegistryAuth: no String-argument constructor/factory method to deserialize from String value (‘swarm’)  </p>
<p>起初pom.xml中docker-maven-plugin的版本是1.0.0，使用mvn package docker:build -e构建Image出现如上异常。<br>百般搜索无果，后来看其他的Spring Boot构建Docker镜像有用的是0.4.3，遂修改之。 </p>
<ol start="2">
<li>解决办法</li>
</ol>
<hr>
<h1 id="将小D课堂里面的插件"><a href="#将小D课堂里面的插件" class="headerlink" title="将小D课堂里面的插件"></a>将小D课堂里面的插件</h1></li>
</ul>
<pre><code> &lt;groupId&gt;com.spotify&lt;/groupId&gt;
&lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt;
&lt;version&gt;1.3.6&lt;/version&gt;
</code></pre><h1 id="改为⭐️⭐️"><a href="#改为⭐️⭐️" class="headerlink" title="改为⭐️⭐️"></a>改为⭐️⭐️</h1>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;groupId&gt;com.spotify&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;docker-maven-plugin&lt;/artifactId&gt; ⭐️ //这边不是dockerfile-maven-plugin了而是docker-maven-plugin</span><br><span class="line">&lt;version&gt;0.4.13&lt;/version&gt;</span><br></pre></td></tr></table></figure>
<p>   ⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️ </p>
<h3 id="第2课-高级篇幅之构建SpringBoot应用docker镜像下集"><a href="#第2课-高级篇幅之构建SpringBoot应用docker镜像下集" class="headerlink" title="第2课 高级篇幅之构建SpringBoot应用docker镜像下集"></a>第2课 高级篇幅之构建SpringBoot应用docker镜像下集</h3><blockquote>
<h4 id="步骤1创建Dockerfile-默认是根目录，（可以修改为src-main-docker-Dockerfile-如果修则需要制定路径）"><a href="#步骤1创建Dockerfile-默认是根目录，（可以修改为src-main-docker-Dockerfile-如果修则需要制定路径）" class="headerlink" title="步骤1创建Dockerfile,默认是根目录，（可以修改为src/main/docker/Dockerfile,如果修则需要制定路径）"></a>步骤1创建Dockerfile,默认是根目录，（可以修改为src/main/docker/Dockerfile,如果修则需要制定路径）</h4></blockquote>
<pre><code>简介:打包SpringCloud镜像并上传私有仓库并部署
1、 什么是Dockerfile : 由一系列命令和参数构成的脚本，这些命令应用于基础镜像, 最终创建一个新的镜       像
实战
FROM openjdk:8-jdk-alpine
VOLUME /tmp
ARG JAR_FILE
COPY ${JAR_FILE} app.jar
ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]


参数讲解：
FROM &lt;image&gt;:&lt;tag&gt; 需要一个基础镜像，可以是公共的或者是私有的， 后续构建会基于此镜像，如果同一个Dockerfile中建立多个镜像时，可以使用多个FROM指令

VOLUME  配置一个具有持久化功能的目录，主机 /var/lib/docker 目录下创建了一个临时文件，并链接到容   器的/tmp。改步骤是可选的，如果涉及到文件系统的应用就很有必要了。/tmp目录用来持久化到 Docker 数据 文件夹，因为 Spring Boot 使用的内嵌 Tomcat 容器默认使用/tmp作为工作目录 

ARG  设置编译镜像时加入的参数， ENV 是设置容器的环境变量
COPY : 只支持将本地文件复制到容器 ,还有个ADD更强大但复杂点
ENTRYPOINT 容器启动时执行的命令
EXPOSE 8080 暴露镜像端口
</code></pre><h3 id="第3课构建镜像"><a href="#第3课构建镜像" class="headerlink" title="第3课构建镜像"></a>第3课构建镜像</h3><pre><code>2、构建镜像
        mvn install dockerfile:build
        打标签
        docker tag a1b9fc71720d registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:docker-demo-v201808
        推送到镜像仓库
        docker push registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:docker-demo-v201808

        应用服务器拉取镜像
        docker pull registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:docker-demo-v201808


        docker run -d --name xdclass_docker_demo1 -p 8099:8080  a1b9fc71720d

        3、查看启动日志 docker logs -f  containerid
</code></pre><h1 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h1><h2 id="1-mvn-install-dockerfile-build。不知道为什么终端没有用idea中终端却有用-😄哈哈"><a href="#1-mvn-install-dockerfile-build。不知道为什么终端没有用idea中终端却有用-😄哈哈" class="headerlink" title="1.mvn install dockerfile:build。不知道为什么终端没有用idea中终端却有用 😄哈哈"></a>1.mvn install dockerfile:build。不知道为什么终端没有用idea中终端却有用 😄哈哈</h2><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-021718.jpg" alt="image-20181111130637806"></p>
<h2 id="2-docker-images"><a href="#2-docker-images" class="headerlink" title="2.docker images"></a>2.docker images</h2><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-021720.jpg" alt="image-20181111130706064"></p>
<blockquote>
<p>没有名字镜像？？注意在idea中测试的话就要用idea 不要随变改成终端</p>
</blockquote>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-021721.jpg" alt="image-20181111131256001"></p>
<h2 id="3-docker-run-d-–name-demo-p-8080-8080-8ef42611e3b0"><a href="#3-docker-run-d-–name-demo-p-8080-8080-8ef42611e3b0" class="headerlink" title="3.docker  run -d –name demo -p 8080:8080  8ef42611e3b0"></a>3.docker  run -d –name demo -p 8080:8080  8ef42611e3b0</h2><blockquote>
<p>备注：运行镜像 –name 指定名字 -d 后台运行 8ef42611e3b0：刚刚构建的image的ID </p>
<p>name 不会用就别用</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-021722.jpg" alt="image-20181111133053363"></p>
</blockquote>
<h3 id="4-docker-ps"><a href="#4-docker-ps" class="headerlink" title="4.docker ps"></a>4.docker ps</h3><blockquote>
<p>查看一下镜像的进程</p>
</blockquote>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fxv1qm8xnmj30xs02g3zi.jpg" alt="image-20181111133138180"></p>
<p>？？？没有程序。测试一下</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/11/并发编程/并发编程/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/11/并发编程/并发编程/" itemprop="url">并发编程慕课网</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-11T10:13:42+08:00">
                2018-11-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/11/并发编程/并发编程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/11/并发编程/并发编程/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023646.jpg" alt="image-20190228135737602"></p>
<hr>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023647.jpg" alt="image-20190228135754241"></p>
<h1 id="1-并发编程的基础"><a href="#1-并发编程的基础" class="headerlink" title="1 并发编程的基础"></a>1 并发编程的基础</h1><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023650.jpg" alt="image-20190228141542431"></p>
<hr>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023651.jpg" alt="image-20190228141659031"></p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/10/SpringCloud/小D课堂springcloud/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/10/SpringCloud/小D课堂springcloud/" itemprop="url">小D课堂SpringCloud笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-10T16:56:31+08:00">
                2018-11-10
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/10/SpringCloud/小D课堂springcloud/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/10/SpringCloud/小D课堂springcloud/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##SpringCloud课程笔记 </p>
<p>第一章 课程介绍和学习路线 </p>
<h3 id="1、微服务架构SpringCloud课程介绍"><a href="#1、微服务架构SpringCloud课程介绍" class="headerlink" title="1、微服务架构SpringCloud课程介绍"></a>1、微服务架构SpringCloud课程介绍</h3><p>​    简介：课程介绍和课程大纲讲解，讲课风格和重点内容理解技</p>
<h3 id="2、技术选型和学后水平"><a href="#2、技术选型和学后水平" class="headerlink" title="2、技术选型和学后水平"></a>2、技术选型和学后水平</h3><p>​    简介：课程所需基础和技术选型讲解，学完课程可以到达怎样的程度，<br>​<br>​    1、IDEA JDK8 Maven SpringBoot基础 Linux<br>​<br>​    2、理解掌握并开发SpringCloud里面主流架构和组件的基础使用，还有部分源码原理的理解<br>​<br>​    3、掌握学习的技巧和解决问题的思路</p>
<p>第二章 架构演进和分布式系统基础知识</p>
<h3 id="1、传统架构演进到分布式架构"><a href="#1、传统架构演进到分布式架构" class="headerlink" title="1、传统架构演进到分布式架构"></a>1、传统架构演进到分布式架构</h3><p>​    简介：讲解单机应用和分布式应用架构演进基础知识 (画图)</p>
<pre><code>    高可用 LVS+keepalive 


1、单体应用：
    开发速度慢
    启动时间长
    依赖庞大
    等等


2、微服务
    易开发、理解和维护
    独立的部署和启动
    等


    不足：
        分布式系统-》分布式事务问题
        需要管理多个服务-》服务治理
</code></pre><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022105.jpg" alt="image-20190316111233001"></p>
<h3 id="2、微服务核心基础讲解"><a href="#2、微服务核心基础讲解" class="headerlink" title="2、微服务核心基础讲解"></a>2、微服务核心基础讲解</h3><p>​    简介：讲解微服务核心知识 ：网关、服务发现注册、配置中心、链路追踪、负载均衡器、熔断<br>​        1、网关：路由转发 + 过滤器<br>​                /api/v1/pruduct/      商品服务<br>​                /api/v1/order/        订单服务<br>​                /api/v1/user/         用户服务</p>
<pre><code>2、服务注册发现：调用和被调用方的信息维护

3、配置中心：管理配置，动态更新 application.properties

4、链路追踪：分析调用链路耗时
    例子：下单-》查询商品服务获取商品价格-》查询用户信息-》保存数据库

5、负载均衡器：分发负载

6、熔断：保护自己和被调用方
</code></pre><h3 id="3、常见的微服务框架"><a href="#3、常见的微服务框架" class="headerlink" title="3、常见的微服务框架"></a>3、常见的微服务框架</h3><p>​    简介:讲解常用的微服务框架</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022106.jpg" alt="image-20190316113743778"></p>
<pre><code>consumer: 调用方  消费者 客户端 client 
provider: 被调用方 服务者 服务端 service
</code></pre><p>​<br>        一个接口一般都会充当两个角色（不是同时充当）</p>
<pre><code>1、dubbo: zookeeper + dubbo + springmvc/springboot
    官方地址：http://dubbo.apache.org/#!/?lang=zh-cn
    配套
        通信方式：rpc
        注册中心：zookeper/redis
        配置中心：diamond

2、springcloud: 全家桶+轻松嵌入第三方组件(Netflix 奈飞)
    官网：http://projects.spring.io/spring-cloud/
    配套
        通信方式：http restful
        注册中心：eruka/consul
        配置中心：config
        断路器：hystrix
        网关：zuul
        分布式追踪系统：sleuth+zipkin

学习资料：https://blog.csdn.net/zhangweiwei2020/article/details/78646252
</code></pre><h3 id="4、微服务下电商项目基础模块设计"><a href="#4、微服务下电商项目基础模块设计" class="headerlink" title="4、微服务下电商项目基础模块设计"></a>4、微服务下电商项目基础模块设计</h3><p>​    简介：微服务下电商项目基础模块设计 分离几个模块，课程围绕这个基础项目进行学习<br>​        小而精的方式学习微服务</p>
<pre><code>1、用户服务
    1）用户信息接口
    2）登录接口

2、商品服务
    1）商品列表
    2）商品详情

3、订单服务 
    1）我的订单
    2）下单接口
</code></pre><h1 id="第三章-SpringCloud核心组件注册中心"><a href="#第三章-SpringCloud核心组件注册中心" class="headerlink" title="第三章 SpringCloud核心组件注册中心"></a>第三章 SpringCloud核心组件注册中心</h1><h3 id="1、什么是微服务的注册中心"><a href="#1、什么是微服务的注册中心" class="headerlink" title="1、什么是微服务的注册中心"></a>1、什么是微服务的注册中心</h3><p>​    简介：讲解什么是注册中心，常用的注册中心有哪些 (画图)<br>​<br>​        理解注册中心：服务管理,核心是有个服务注册表，心跳机制动态维护<br>​<br>​        服务提供者provider: 启动的时候向注册中心上报自己的网络信息<br>​<br>​        服务消费者consumer: 启动的时候向注册中心上报自己的网络信息，拉取provider的相关网络信息</p>
<pre><code>为什么要用：
    微服务应用和机器越来越多，调用方需要知道接口的网络地址，如果靠配置文件的方式去控制网络地址，对于动态新增机器，维护带来很大问题

主流的注册中心：
    zookeeper、Eureka、consul、etcd 等
</code></pre><p>​        </p>
<h3 id="2、分布式应用知识CAP理论知识"><a href="#2、分布式应用知识CAP理论知识" class="headerlink" title="2、分布式应用知识CAP理论知识"></a>2、分布式应用知识CAP理论知识</h3><p>​    简介：讲解分布式核心知识CAP理论</p>
<pre><code>CAP定理：
    指的是在一个分布式系统中，Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可同时获得。




一致性（C）：在分布式系统中的所有数据备份，在同一时刻是否同样的值。（所有节点在同一时间的数据完全一致，越多节点，数据同步越耗时）
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可用性（A）：负载过大后，集群整体是否还能响应客户端的读写请求。（服务一直可用，而且是正常响应时间）</span><br></pre></td></tr></table></figure>
<pre><code>分区容错性（P）：分区容忍性，就是高可用性，一个节点崩了，并不影响其它的节点（100个节点，挂了几个，不影响服务，越多机器越好）


CAP理论就是说在分布式存储系统中，最多只能实现上面的两点。而由于当前的网络硬件肯定会出现延迟丢包等问题，所以分区容忍性是我们必须需要实现的。所以我们只能在一致性和可用性之间进行权衡
</code></pre><p>​        </p>
<p>###3、分布式系统CAP原理常见面试题和注册中心选择<br>​        简介:讲解CAP原则在面试中回答和注册中心选择</p>
<pre><code>C A 满足的情况下，P不能满足的原因：
    数据同步(C)需要时间，也要正常的时间内响应(A)，那么机器数量就要少，所以P就不满足

CP 满足的情况下，A不能满足的原因：
    数据同步(C)需要时间, 机器数量也多(P)，但是同步数据需要时间，所以不能再正常时间内响应，所以A就不满足

AP 满足的情况下，C不能满足的原因：
    机器数量也多(P)，正常的时间内响应(A)，那么数据就不能及时同步到其他节点，所以C不满足

注册中心选择：
    Zookeeper：CP设计，保证了一致性，集群搭建的时候，某个节点失效，则会进行选举行的leader，或者半数以上节点不可用，则无法提供服务，因此可用性没法满足

    Eureka：AP原则，无主从节点，一个节点挂了，自动切换其他节点可以使用，去中心化



结论：分布式系统中P,肯定要满足，所以只能在CA中二选一
    没有最好的选择，最好的选择是根据业务场景来进行架构设计

    如果要求一致性，则选择zookeeper，如金融行业

    如果要去可用性，则Eureka，如电商系统
</code></pre><h3 id="4、SpringCloud微服务核心组件Eureka介绍和闭源后影响"><a href="#4、SpringCloud微服务核心组件Eureka介绍和闭源后影响" class="headerlink" title="4、SpringCloud微服务核心组件Eureka介绍和闭源后影响"></a>4、SpringCloud微服务核心组件Eureka介绍和闭源后影响</h3><p>​    简介：<br>​        SpringCloud体系介绍<br>​            官方地址：<a href="http://projects.spring.io/spring-cloud/" target="_blank" rel="noopener">http://projects.spring.io/spring-cloud/</a></p>
<pre><code>    Eureka的基础知识--&gt;画图讲解交互流程，服务提供者&lt;--&gt;服务消费者 ;

    Eureka 2.x闭源后选择

参考：https://www.jianshu.com/p/d32ae141f680
     https://blog.csdn.net/zjcjava/article/details/78608892
</code></pre><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-22107.jpg" alt="image-20190316130552646">–</p>
<h3 id="5、服务注册和发现Eureka-Server搭建实战"><a href="#5、服务注册和发现Eureka-Server搭建实战" class="headerlink" title="5、服务注册和发现Eureka Server搭建实战"></a>5、服务注册和发现Eureka Server搭建实战</h3><p>​    简介：使用IDEA搭建Eureka服务中心Server端并启动，项目基本骨架介绍<br>​<br>​    官方文档：<a href="http://cloud.spring.io/spring-cloud-netflix/single/spring-cloud-netflix.html#spring-cloud-eureka-server" target="_blank" rel="noopener">http://cloud.spring.io/spring-cloud-netflix/single/spring-cloud-netflix.html#spring-cloud-eureka-server</a><br>​<br>​    第一步：创建项目<br>​    第二步: 添加注解 @EnableEurekaServer<br>​    第三步：增加配置application.yml<br>​            server:<br>​              port: 8761<br>​<br>​            eureka:<br>​              instance:<br>​                hostname: localhost<br>​              client:<br>​              #声明自己是个服务端<br>​                registerWithEureka: false<br>​                fetchRegistry: false<br>​                serviceUrl:<br>​                  defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/<br>​    </p>
<pre><code>第四步：访问注册中心页面

maven地址: https://www.cnblogs.com/sword-successful/p/6408281.html
</code></pre><p>6、服务注册和发现之Eureka Client搭建商品服务实战<br>​    简介：搭建用商品服务，并将服务注册到注册中心</p>
<pre><code>1、创建一个SpirngBoot应用，增加服务注册和发现依赖
2、模拟商品信息，存储在内存中

3、开发商品列表接口，商品详情接口

4、配置文件加入注册中心地址
    使用eureka客户端 官方文档：http://cloud.spring.io/spring-cloud-netflix/single/spring-cloud-netflix.html#netflix-eureka-client-starter
</code></pre><p>7、Eureka服务注册中心配置控制台问题处理<br>​    简介：讲解服务注册中心管理后台，（后续还会细讲）</p>
<pre><code>问题：eureka管理后台出现一串红色字体：是警告，说明有服务上线率低

EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY&apos;RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.

关闭检查方法：eureka服务端配置文件加入
server:
    enable-self-preservation: false
注意：自我保护模式禁止关闭，默认是开启状态true
</code></pre><p>​<br>​    问题二：为什么只加一个注册中心地址，就可以注册<br>​    By having spring-cloud-starter-netflix-eureka-client on the classpath, your application automatically registers with the Eureka Server. Configuration is required to locate the Eureka server, as shown in the following example:</p>
<p>第四章 服务消费者ribbon和feign实战和注册中心高可用</p>
<p>1、常用的服务间调用方式讲解<br>​    简介：讲解常用的服务间的调用方式</p>
<pre><code>RPC:
    远程过程调用，像调用本地服务(方法)一样调用服务器的服务
    支持同步、异步调用
    客户端和服务器之间建立TCP连接，可以一次建立一个，也可以多个调用复用一次链接

    PRC数据包小
        protobuf
        thrift
    rpc：编解码，序列化，链接，丢包，协议


Rest(Http):
    http请求，支持多种协议和功能
    开发方便成本低

    http数据包大

    java开发：HttpClient，URLConnection
</code></pre><p>2、微服务调用方式之ribbon实战 订单调用商品服务<br>​    简介：实战电商项目 订单服务 调用商品服务获取商品信息<br>​        1、创建order_service项目<br>​        2、开发伪下单接口<br>​        3、使用ribbon. (类似httpClient,URLConnection) </p>
<pre><code>    启动类增加注解
      @Bean
      @LoadBalanced
      public RestTemplate restTemplate() {
           return new RestTemplate();
      }
4、根据名称进行调用商品，获取商品详情
</code></pre><p>3、高级篇幅之Ribbon负载均衡源码分析实战<br>​    简介: 讲解ribbon服务间调用负载均衡源码分析<br>​        1、完善下单接口<br>​        2、分析@LoadBalanced<br>​            1）首先从注册中心获取provider的列表<br>​            2）通过一定的策略选择其中一个节点</p>
<pre><code>3）再返回给restTemplate调用
</code></pre><h1 id=""><a href="#" class="headerlink" title="============================================="></a>=============================================</h1><p>4、高级篇幅之服务间调用之负载均衡策略调整实战<br>​    简介：实战调整默认负载均衡策略实战</p>
<pre><code>自定义负载均衡策略：http://cloud.spring.io/spring-cloud-static/Finchley.RELEASE/single/spring-cloud.html#_customizing_the_ribbon_client_by_setting_properties

在配置文件yml里面，自定义负载均衡策略
    #自定义负载均衡策略
    product-service:
      ribbon:
        NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RandomRule

策略选择：
    1、如果每个机器配置一样，则建议不修改策略 (推荐)
    2、如果部分机器配置强，则可以改为 WeightedResponseTimeRule
</code></pre><p>5、微服务调用方式之feign 实战 订单调用商品服务<br>​    简介：改造电商项目 订单服务 调用商品服务获取商品信息<br>​        Feign： 伪RPC客户端(本质还是用http)<br>​        官方文档: <a href="https://cloud.spring.io/spring-cloud-openfeign/" target="_blank" rel="noopener">https://cloud.spring.io/spring-cloud-openfeign/</a></p>
<pre><code>1、使用feign步骤讲解（新旧版本依赖名称不一样）
    加入依赖
         &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;
        &lt;/dependency&gt;
    启动类增加@EnableFeignClients
    增加一个接口 并@FeignClient(name=&quot;product-service&quot;)

2、编码实战


3、注意点：
    1、路径
    2、Http方法必须对应
    3、使用requestBody，应该使用@PostMapping
    4、多个参数的时候，通过@RequestParam（&quot;id&quot;) int id)方式调用
</code></pre><p>6、Feign核心源码解读和服务调用方式ribbon和Feign选择<br>​    简介: 讲解Feign核心源码解读和 服务间的调用方式ribbon、feign选择<br>​<br>​        1、ribbon和feign两个的区别和选择<br>​            选择feign<br>​                默认集成了ribbon<br>​                写起来更加思路清晰和方便<br>​                采用注解方式进行配置，配置熔断等方式方便<br>​<br>​        2、超时配置<br>​            默认optons readtimeout是60，但是由于hystrix默认是1秒超时<br>​    </p>
<pre><code>#修改调用超时时间
feign:
  client:
    config:
      default:
        connectTimeout: 2000
        readTimeout: 2000

模拟接口响应慢，线程睡眠新的方式
  try {
        TimeUnit.SECONDS.sleep(1);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
</code></pre><p>第五章 互联网架构服务降级熔断 Hystrix 实战</p>
<p>1、分布式核心知识之熔断、降级讲解<br>​    简介：系统负载过高，突发流量或者网络等各种异常情况介绍，常用的解决方案</p>
<pre><code>1、熔断：
    保险丝，熔断服务，为了防止整个系统故障，包含子和下游服务

    下单服务 -》商品服务
            -》用户服务 （出现异常-》熔断）

2、降级：
    抛弃一些非核心的接口和数据

    旅行箱的例子：只带核心的物品，抛弃非核心的，等有条件的时候再去携带这些物品
</code></pre><p>​<br>​    3、熔断和降级互相交集<br>​        相同点：<br>​            1）从可用性和可靠性触发，为了防止系统崩溃<br>​            2）最终让用户体验到的是某些功能暂时不能用<br>​<br>​        不同点<br>​            1）服务熔断一般是下游服务故障导致的，而服务降级一般是从整体系统负荷考虑，由调用方控制</p>
<p>2、Netflix开源组件断路器Hystrix介绍<br>​    简介：介绍Hystrix基础知识和使用场景<br>​<br>​    文档地址：<br>​        <a href="https://github.com/Netflix/Hystrix" target="_blank" rel="noopener">https://github.com/Netflix/Hystrix</a><br>​        <a href="https://github.com/Netflix/Hystrix/wiki" target="_blank" rel="noopener">https://github.com/Netflix/Hystrix/wiki</a><br>​<br>​    1、什么是Hystrix？<br>​        1）hystrix对应的中文名字是“豪猪”<br>​<br>        2）hystrix    英[hɪst’rɪks] 美[hɪst’rɪks]</p>
<p>​<br>​    2、为什么要用？<br>​        在一个分布式系统里，一个服务依赖多个服务，可能存在某个服务调用失败，<br>​        比如超时、异常等，如何能够保证在一个依赖出问题的情况下，不会导致整体服务失败，<br>​        通过Hystrix就可以解决<br>​<br>​        <a href="http://cloud.spring.io/spring-cloud-netflix/single/spring-cloud-netflix.html#_circuit_breaker_hystrix_clients" target="_blank" rel="noopener">http://cloud.spring.io/spring-cloud-netflix/single/spring-cloud-netflix.html#_circuit_breaker_hystrix_clients</a><br>​<br>​    3、提供了熔断、隔离、Fallback、cache、监控等功能</p>
<pre><code>4、熔断后怎么处理？
    出现错误之后可以 fallback 错误的处理信息

    兜底数据
</code></pre><p>3、Feign结合Hystrix断路器开发实战《上》<br>​    简介：讲解SpringCloud整合断路器的使用，用户服务异常情况</p>
<pre><code>1、加入依赖

注意：网上新旧版本问题，所以要以官网为主，不然部分注解会丢失
最新版本 2.0

    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
    &lt;/dependency&gt;


2、增加注解
    启动类里面增加注解
    @EnableCircuitBreaker

    注解越来越多-》 SpringCloudApplication注解

3、API接口编码实战
  熔断-》降级

    1）最外层api使用，好比异常处理（网络异常，参数或者内部调用问题）
        api方法上增加 @HystrixCommand(fallbackMethod = &quot;saveOrderFail&quot;)

        编写fallback方法实现，方法签名一定要和api方法签名一致（注意点！！！）
</code></pre><p>​        </p>
<pre><code>补充： 修改maven仓库地址
pom.xml中修改

&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;nexus-aliyun&lt;/id&gt;
        &lt;name&gt;Nexus aliyun&lt;/name&gt;
        &lt;layout&gt;default&lt;/layout&gt;
        &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public&lt;/url&gt;
        &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
        &lt;/snapshots&gt;
        &lt;releases&gt;
            &lt;enabled&gt;true&lt;/enabled&gt;
        &lt;/releases&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;
</code></pre><p>4、Feign结合Hystrix断路器开发实战《下》<br>​    简介：讲解SpringCloud整合断路器的使用，用户服务异常情况<br>​    1、feign结合Hystrix<br>​<br>​        1）开启feign支持hystrix  (注意，一定要开启，旧版本默认支持，新版本默认关闭)<br>​            feign:<br>​              hystrix:<br>​                enabled: true<br>​<br>​        2）FeignClient(name=”xxx”, fallback=xxx.class ), class需要继承当前FeignClient的类</p>
<p>5、熔断降级服务异常报警通知实战<br>​    简介：完善服务熔断处理，报警机制完善</p>
<pre><code>1、加入redis依赖
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
    &lt;/dependency&gt;
2、配置redis链接信息
  redis:
    database: 0
    host: 127.0.0.1
    port: 6379
    timeout: 2000

3、使用

    //监控报警
    String saveOrderKye = &quot;save-order&quot;;
    String sendValue = redisTemplate.opsForValue().get(saveOrderKye);
    final String ip = request.getRemoteAddr();
    new Thread( ()-&gt;{
        if (StringUtils.isBlank(sendValue)) {
            System.out.println(&quot;紧急短信，用户下单失败，请离开查找原因,ip地址是=&quot;+ip);
            //发送一个http请求，调用短信服务 TODO
            redisTemplate.opsForValue().set(saveOrderKye, &quot;save-order-fail&quot;, 20, TimeUnit.SECONDS);
        }else{
            System.out.println(&quot;已经发送过短信，20秒内不重复发送&quot;);
        }
    }).start();
</code></pre><p>6、高级篇幅之深入源码剖析Hystrix降级策略和调整<br>​    简介：源码分析Hystrix降级策略和调整</p>
<pre><code>1、查看默认讲解策略 HystrixCommandProperties
    1）execution.isolation.strategy   隔离策略
        THREAD 线程池隔离 （默认）
        SEMAPHORE 信号量
            信号量适用于接口并发量高的情况，如每秒数千次调用的情况，导致的线程开销过高，通常只适用于非网络调用，执行速度快

    2）execution.isolation.thread.timeoutInMilliseconds  超时时间
        默认 1000毫秒

    3）execution.timeout.enabled 是否开启超时限制 （一定不要禁用）


    4）execution.isolation.semaphore.maxConcurrentRequests 隔离策略为 信号量的时候，如果达到最大并发数时，后续请求会被拒绝，默认是10


官方文档:
    https://github.com/Netflix/Hystrix/wiki/Configuration#execution.isolation.strategy

2、调整策略
    超时时间调整

hystrix:
  command:
    default:
      execution:
        isolation:
          thread:
            timeoutInMilliseconds: 4000
</code></pre><p>7、断路器Dashboard监控仪表盘实战<br>​    简介：讲解断路器Dashboard基础使用和查看<br>​    1、加入依赖<br>​         <dependency><br>​            <groupid>org.springframework.cloud</groupid><br>​            <artifactid>spring-cloud-starter-netflix-hystrix-dashboard</artifactid><br>​        </dependency></p>
<pre><code>    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
    &lt;/dependency&gt;

2、启动类增加注解
    @EnableHystrixDashboard
</code></pre><p>​<br>​    3、配置文件增加endpoint<br>management:<br>  endpoints:<br>​    web:<br>​      exposure:<br>​        include: “*”</p>
<pre><code>4、访问入口
    http://localhost:8781/hystrix

    Hystrix Dashboard输入： http://localhost:8781/actuator/hystrix.stream 
</code></pre><p>​<br>​    参考资料<br>​        默认开启监控配置<br>​        <a href="https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#boot-features-security-actuator" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#boot-features-security-actuator</a><br>​<br>​        配置文件类：<br>​            spring-configuration-metadata.json</p>
<p>8、断路器监控仪表参数讲解和模拟熔断<br>​    简介：讲解 断路器监控仪表盘参数和模拟熔断</p>
<pre><code>1、sse  server-send-event推送到前端

资料：https://github.com/Netflix/Hystrix/wiki/Dashboard
</code></pre><p>第六章 微服务网关zuul开发实战 </p>
<p>1、微服务网关介绍和使用场景<br>​    简介：讲解网关的作用和使用场景 (画图)<br>​<br>​    1）什么是网关<br>​        API Gateway，是系统的唯一对外的入口，介于客户端和服务器端之间的中间层，处理非业务功能 提供路由请求、鉴权、监控、缓存、限流等功能<br>​<br>​            统一接入<br>​                智能路由<br>​                AB测试、灰度测试<br>​                负载均衡、容灾处理<br>​                日志埋点（类似Nignx日志）<br>​<br>            流量监控<br>                限流处理<br>                服务降级</p>
<pre><code>        安全防护
            鉴权处理
            监控
            机器网络隔离


2）主流的网关
    zuul：是Netflix开源的微服务网关，和Eureka,Ribbon,Hystrix等组件配合使用，Zuul 2.0比1.0的性能提高很多

    kong: 由Mashape公司开源的，基于Nginx的API gateway

    nginx+lua：是一个高性能的HTTP和反向代理服务器,lua是脚本语言，让Nginx执行Lua脚本，并且高并发、非阻塞的处理各种请求
</code></pre><p>2、SpringCloud的网关组件zuul基本使用<br>​    简介：讲解zuul网关基本使用</p>
<pre><code>1、加入依赖


2、启动类加入注解 @EnableZuulProxy
    默认集成断路器  @EnableCircuitBreaker

    默认访问规则  
        http://gateway:port/service-id/**

            例子：默认 /order-service/api/v1/order/save?user_id=2&amp;product_id=1
                 自定义 /xdclass_order/api/v1/order/save?user_id=2&amp;product_id=1

    自定义路由转发：
        zuul:
         routes:
             order-service: /apigateway/**


    环境隔离配置：
        需求 ：不想让默认的服务对外暴露接口
            /order-service/api/v1/order/save

        配置：
        zuul: 
            ignored-patterns:
                - /*-service/api/v1/order/save
</code></pre><p>3、高级篇幅之Zuul常用问题分析和网关过滤器原理分析</p>
<pre><code>简介：讲解Zuul网关原理和过滤器生命周期，

1、路由名称定义问题
    路由映射重复覆盖问题

2、Http请求头过滤问题

3、过滤器执行顺序问题 ，过滤器的order值越小，越先执行


4、共享RequestContext，上下文对象
</code></pre><p>4、自定义Zuul过滤器实现登录鉴权实战<br>​    简介：自定义Zuul过滤器实现登录鉴权实战</p>
<pre><code>1、新建一个filter包

2、新建一个类，实现ZuulFilter，重写里面的方法

3、在类顶部加注解，@Component,让Spring扫描
</code></pre><p>5、高级篇幅之高并发情况下接口限流特技<br>​    简介：谷歌guava框架介绍，网关限流使用</p>
<pre><code>1、nginx层限流

2、网关层限流
</code></pre><p>6、Zuul微服务网关集群搭建<br>​    简介：微服务网关Zull集群搭建</p>
<pre><code>1、nginx+lvs+keepalive 
https://www.cnblogs.com/liuyisai/p/5990645.html
</code></pre><p>第七章 分布式链路追踪系统Sleuth和ZipKin实战<br>​    </p>
<pre><code>1、微服务下的链路追踪讲解和重要性
    简介：讲解什么是分布式链路追踪系统，及使用好处




2、SpringCloud的链路追踪组件Sleuth实战
    简介：讲解分布式链路追踪组件Sleuth实战

    1、官方文档
    http://cloud.spring.io/spring-cloud-static/Finchley.SR1/single/spring-cloud.html#sleuth-adding-project

    2、什么是Sleuth
        一个组件，专门用于记录链路数据的开源组件

        [order-service,96f95a0dd81fe3ab,852ef4cfcdecabf3,false]

        1、第一个值，spring.application.name的值

        2、第二个值，96f95a0dd81fe3ab ，sleuth生成的一个ID，叫Trace ID，用来标识一条请求链路，一条请求链路中包含一个Trace ID，多个Span ID

        3、第三个值，852ef4cfcdecabf3、spanid 基本的工作单元，获取元数据，如发送一个http

        4、第四个值：false，是否要将该信息输出到zipkin服务中来收集和展示。

    3、添加依赖
        &lt;dependency&gt;
         &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
         &lt;artifactId&gt;spring-cloud-starter-sleuth&lt;/artifactId&gt;
         &lt;/dependency&gt;






3、SpringCloud的链路追踪组件Sleuth常见问题说明
    简介：讲解分布式链路追踪组件Sleuth常见问题说明
</code></pre><p>​      </p>
<pre><code>4、可视化链路追踪系统Zipkin部署
    简介：讲解Zipkin的介绍和部署
    1、什么是zipkin
        官网：https://zipkin.io/
        大规模分布式系统的APM工具（Application Performance Management）,基于Google Dapper的基础实现，和sleuth结合可以提供可视化web界面分析调用链路耗时情况            

    2、同类产品
        鹰眼（EagleEye）
        CAT
        twitter开源zipkin，结合sleuth
        Pinpoint，运用JavaAgent字节码增强技术
        StackDriver Trace (Google) 

    3、开始使用
        https://github.com/openzipkin/zipkin
        https://zipkin.io/pages/quickstart.html

        zipkin组成：Collector、Storage、Restful API、Web UI组成

    4、知识拓展：OpenTracing
    OpenTracing 已进入 CNCF，正在为全球的分布式追踪，提供统一的概念和数据标准。 
    通过提供平台无关、厂商无关的 API，使得开发人员能够方便的添加（或更换）追踪系统的实现。


    推荐阅读：
        http://blog.daocloud.io/cncf-3/
        https://www.zhihu.com/question/27994350
        https://yq.aliyun.com/articles/514488?utm_content=m_43347







5、高级篇幅之链路追踪组件Zipkin+Sleuth实战
    简介：使用Zipkin+Sleuth业务分析调用链路分析实战

    1、文档
    http://cloud.spring.io/spring-cloud-static/Finchley.SR1/single/spring-cloud.html#_sleuth_with_zipkin_via_http

      sleuth收集跟踪信息通过http请求发送给zipkin server，zipkinserver进行跟踪信息的存储以及提供Rest API即可，Zipkin UI调用其API接口进行数据展示

      默认存储是内存，可也用mysql、或者elasticsearch等存储

    2、加入依赖
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-zipkin&lt;/artifactId&gt;
    &lt;/dependency&gt;

    里面包含 spring-cloud-starter-sleuth、spring-cloud-sleuth-zipkin

    3、文档说明：http://cloud.spring.io/spring-cloud-static/Finchley.SR1/single/spring-cloud.html#_features_2

    4、配置zipkin.base-url

    5、配置采样百分闭spring.sleuth.sampler


    推荐资料：
        https://blog.csdn.net/jrn1012/article/details/77837710
</code></pre><p>=============================================<br>更多干货技术访问小D课堂官网 <a href="https://xdclass.net" target="_blank" rel="noopener">https://xdclass.net</a><br>小D老师个人微信：jack794666918</p>
<h1 id="公众号搜索：小D课堂"><a href="#公众号搜索：小D课堂" class="headerlink" title="公众号搜索：小D课堂"></a>公众号搜索：小D课堂</h1><p>​<br>第八章 微服务核心知识分布式配置中心Config实战<br>​<br>​    1、微服务下的分布式配置中心<br>​        简介：讲解什么是配置中心及使用前后的好处 (画图)<br>​        什么是配置中心：<br>​            一句话：统一管理配置, 快速切换各个环境的配置<br>​<br>​        相关产品：<br>​            百度的disconf<br>​                地址:<a href="https://github.com/knightliao/disconf" target="_blank" rel="noopener">https://github.com/knightliao/disconf</a><br>​<br>​            阿里的diamand<br>​                地址：<a href="https://github.com/takeseem/diamond" target="_blank" rel="noopener">https://github.com/takeseem/diamond</a><br>​<br>​            springcloud的configs-server:<br>​                地址：<a href="http://cloud.spring.io/spring-cloud-config/" target="_blank" rel="noopener">http://cloud.spring.io/spring-cloud-config/</a></p>
<pre><code>    推荐干货文章：http://jm.taobao.org/2016/09/28/an-article-about-config-center/





2、SpringCloud的配置中心组件config-server实战
    简介：讲解SpringCloud配置中心config-server实战
    1、新建项目，创建config-server
    2、启动类增加注解
        @EnableConfigServer












3、使用git服务器结合Config搭建分布式配置中心
    简介：讲解使用git服务器结合Config搭建分布式配置中心

    1、默认使用git存储配置中心
        使用git服务器，可以自己搭建gitlab服务器
        或者使用github、开源中国git、阿里云git

        794666918@qq.com
        xdclass.net123

        https://gitee.com/waitforxy/config_cloud.git

    2、配置文件添加配置
        spring:
          application:
            name: config-server
        #git配置
          cloud:
            config:
              server:
                git:
                  uri: https://gitee.com/waitforxy/config_cloud
                  username: 794666918@qq.com
                  password: xdclass.net123
                  #超时时间
                  timeout: 5
                    #分支
                    default-label: master


    3、访问方式（一定要注意语法，如果有问题，会出错）
        多种访问路径，可以通过启动日志去查看
        例子 http://localhost:9100/product-service.yml

        /{name}-{profiles}.properties
        /{name}-{profiles}.yml
        /{name}-{profiles}.json
        /{label}/{name}-{profiles}.yml

        name 服务器名称
        profile 环境名称，开发、测试、生产
        lable 仓库分支、默认master分支
</code></pre><p>4、分布式配置中心客户端使用实战<br>​    简介：微服务里面客户端接入配置中心实战<br>​        官方文档：<a href="http://cloud.spring.io/spring-cloud-config/single/spring-cloud-config.html#_spring_cloud_config_client" target="_blank" rel="noopener">http://cloud.spring.io/spring-cloud-config/single/spring-cloud-config.html#_spring_cloud_config_client</a><br>​<br>​        1、加入依赖<br>​             <dependency><br>​                <groupid>org.springframework.cloud</groupid><br>​                <artifactid>spring-cloud-config-client</artifactid><br>​            </dependency><br>​<br>​         2、修改对应服务的配置文件,把application.yml 改为 bootstrap.yml<br>​            #指定注册中心地址<br>​            eureka:<br>​              client:<br>​                serviceUrl:<br>​                  defaultZone: <a href="http://localhost:8761/eureka/" target="_blank" rel="noopener">http://localhost:8761/eureka/</a><br>​    </p>
<pre><code>    #服务的名称
    spring:
      application:
        name: product-service
      #指定从哪个配置中心读取
      cloud:
        config:
          discovery:
            service-id: CONFIG-SERVER
            enabled: true
          profile: test
          #建议用lable去区分环境，默认是lable是master分支
          #label: test

注意点：
    1.配置文件要用bootstrap.yml
    2.默认读取文件名是 服务名称
</code></pre><p>第九章 微服务消息总线Bus结合消息队列RabbitMQ实战</p>
<pre><code>1、消息总线Bus介绍和使用场景
    简介：讲解消息总线Bus介绍和使用场景
    1、什么是消息
        一个事件，需要广播或者单独传递给某个接口

    2、为什么使用这个
        配置更新了，但是其他系统不知道是否更新









2、消息队列和RabbitMQ基础介绍
    简介：消息队列和RabbitMQ基础介绍

        1、消息队列介绍
            参考：https://www.cnblogs.com/linjiqin/p/5720865.html

        2、同类产品
            ActiveMQ
            RocketMQ
            Kafka
            等

        3、SpringCloud默认推荐使用RabbitMQ


        4、RabbitMQ介绍    
            官方文档：http://www.rabbitmq.com/getstarted.html
            中文文档：http://rabbitmq.mr-ping.com/





3、实战系列使用Docker搭建RabbitMQ3.7
    简介：使用Docker安装RabbitMQ

    1、如果对Docker没基础，课程后续有讲解Docker，可以先跳转过去学习Docker
    2、安装步骤
        1)拉取镜像：docker pull rabbitmq:management
        2)查看当前镜像列表：docker images
        3)删除指定镜像：docker rmi  IMAGE_ID  (如果需要强制删除加 -f)

        4)创建容器
        docker run -d --name=&quot;myrabbitmq&quot; -p 5671:5671 -p 15672:15672 rabbitmq:management

        参数讲解: 
            run: 创建一个新的容器并运行一个命令
             -d: 后台运行容器，并返回容器ID
             -p: 端口映射，格式为：主机(宿主)端口:容器端口
             --name=&quot;rabbitmq&quot;: 为容器指定一个名称


    3、RabbitMQ默认创建了一个 guest 用户，密码也是 guest, 如果访问不了记得查看防火墙，端口或者云服务器的安全组
      管理后台：http://127.0.0.1:15672


其他安装方式：
Linux安装：https://blog.csdn.net/qq_34021712/article/details/72567786
windows安装：http://www.rabbitmq.com/install-windows.html

https://blog.csdn.net/liyuejin/article/details/78410586





4、高级篇幅消息总线整合配置中心架构流程图
    简介：讲解消息总线Bus结合config组件搭建配置中心项目架构图和操作流程

        启动
        rabbitmq： docker run -d -p 5672:5672 -p 15672:15672 rabbitmq:management
        rabbitmq默认是5672,所以改为5672端口

        1、config-client加入依赖

            &lt;!--配置中心结合消息队列--&gt;

            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
            &lt;/dependency&gt;

            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
                &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt;
            &lt;/dependency&gt;
</code></pre><p>​<br>​            官方文档：<a href="http://cloud.spring.io/spring-cloud-bus/single/spring-cloud-bus.html#_bus_refresh_endpoint" target="_blank" rel="noopener">http://cloud.spring.io/spring-cloud-bus/single/spring-cloud-bus.html#_bus_refresh_endpoint</a><br>​            文档里面 暴露端点 management.endpoints.web.exposure.include=bus-refresh<br>​<br>​            2、在配置文件中增加关于RabbitMQ的连接(如果是本机，则可以直接启动，采用默认连接配置)<br>​                spring:<br>​                  rabbitmq:<br>​                    host: localhost<br>​                    port: 5672<br>​                    username: guest<br>​                    password: guest<br>​<br>​                #暴露全部的监控信息<br>​                management:<br>​                  endpoints:<br>​                    web:<br>​                      exposure:<br>​                        include: “*”<br>​<br>​            3、需要刷新配置的地方，增加注解<br>​                @RefreshScope<br>​<br>​            4、访问验证 post方式：<br>​                <a href="http://localhost:8773/actuator/bus-refresh" target="_blank" rel="noopener">http://localhost:8773/actuator/bus-refresh</a></p>
<pre><code>        5、动态刷新配置: 在开发和测试环境使用，尽量少在生产环境使用








5、微服务相关项目改造配置中心
简介：把课程项目改造成配置中心讲解

1、git里面新增对应项目的配置文件，都要添加下面的配置
    #服务的名称
    spring:
      rabbitmq:
        host: localhost
        port: 5672
        username: guest
        password: guest

    #暴露全部的监控信息
    management:
      endpoints:
        web:
          exposure:
            include: &quot;*&quot;
</code></pre><p>​<br>​    2、项目里面添加maven依赖<br>​<br>​        <!--配置中心客户端--><br>​        <dependency><br>​            <groupid>org.springframework.cloud</groupid><br>​            <artifactid>spring-cloud-config-client</artifactid><br>​        </dependency><br>​<br>​        <!--config server--><br>​<br>​        <dependency><br>​            <groupid>org.springframework.boot</groupid><br>​            <artifactid>spring-boot-starter-actuator</artifactid><br>​        </dependency><br>​<br>​        <dependency><br>​            <groupid>org.springframework.cloud</groupid><br>​            <artifactid>spring-cloud-starter-bus-amqp</artifactid><br>​        </dependency></p>
<pre><code>3、修改application.properties为bootstrap.yml 并拷贝配置文件

        #指定注册中心地址
        eureka:
          client:
            serviceUrl:
              defaultZone: http://localhost:8761/eureka/

        #服务的名称
        spring:
          application:
            name: order-service
          #指定从哪个配置中心读取
          cloud:
            config:
              discovery:
                service-id: CONFIG-SERVER
                enabled: true
              profile: test

4、各个项目启动顺序
    1）注册中心
    2）配置中心
    3）对应的服务：商品服务、订单服务。。。
    4）启动网关
</code></pre><p>第十章、SpringCloud课程内容上半部分总结<br>​    </p>
<pre><code>1、微服务核心知识内容回顾

简介：回顾SpringCloud前面10章的基础内容

    1)介绍微服务的基础知识，核心组件，CAP原理

    2）SpringCloud注册中心 Eureka

    3）product-service / order-service

    4) 伪RPC Ribbon / feign 

    5) hystrix熔断

    6) 服务网关介绍，zuul

    7）配置中心config-server
</code></pre><p>​    </p>
<pre><code>2、微服务下半部分知识 云服务器和Docker容器
    简介：讲解云服务器和容器知识
</code></pre><p>​    </p>
<p>第十一章 阿里云ECS服务器介绍和网络知识讲解</p>
<pre><code>1、云服务器介绍和阿里云服务器ECS服务器选购
    简介：什么是云服务器及目前主要的几个厂商介绍
    1、阿里云、腾讯云、亚马逊云
    阿里云：https://www.aliyun.com/
    腾讯云：https://cloud.tencent.com/
    亚马逊云：https://aws.amazon.com/
</code></pre><p>​<br>​    2、阿里云服务器远程登录和常用工具<br>​        简介：讲解阿里云服务器登录使用和常见终端工具<br>​        1、windows工具   putty，xshell, security<br>​            参考资料：<br>​                <a href="https://jingyan.baidu.com/article/e75057f210c6dcebc91a89dd.html" target="_blank" rel="noopener">https://jingyan.baidu.com/article/e75057f210c6dcebc91a89dd.html</a><br>​                <a href="https://www.jb51.net/softjc/88235.html" target="_blank" rel="noopener">https://www.jb51.net/softjc/88235.html</a><br>​<br>​        2、苹果系统MAC： 通过终端登录<br>​            ssh root@ip  回车后输入密码<br>​            ssh <a href="mailto:root@120.25.1.38" target="_blank" rel="noopener">root@120.25.1.38</a><br>​<br>​        3、可以尝试自己通过百度进行找文档， 安装mysql jdk  nginx maven git redis elk </p>
<p>3、互联网架构知识之网站部署上线基础准备<br>​    简介：讲解应用部署到可以公网访问需要步骤</p>
<pre><code>1、一个http请求的故事

2、什么是cname和a记录
        A记录和CNAME只可以同时生效一个，A记录优先

3、域名和ip的关系，DNS作用


参考资料：
    https://blog.csdn.net/benbenzhuhwp/article/details/44704319

    https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=0&amp;rsv_idx=1&amp;ch=1&amp;tn=98050039_dg&amp;wd=%E4%B8%80%E4%B8%AAhttp%E8%AF%B7%E6%B1%82%E7%9A%84%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B&amp;rsv_pq=80a65c5f00005961&amp;rsv_t=a5fcWreuJzILdSwr4gI8pFqlO7HSu5BlhjwalyVzPiV9w2L%2BKEj78pPi1Qn6Vx4wXxI&amp;rqlang=cn&amp;rsv_enter=1&amp;rsv_sug3=8&amp;rsv_sug1=8&amp;rsv_sug7=100&amp;sug=%25E4%25B8%2580%25E4%25B8%25AAhttp%25E8%25AF%25B7%25E6%25B1%2582%25E7%259A%2584%25E8%25AF%25A6%25E7%25BB%2586%25E8%25BF%2587%25E7%25A8%258B&amp;rsv_n=1
</code></pre><p>4、域名购买和配置解析实战<br>​    简介：域名购买和配置解析实战</p>
<pre><code>1、购买域名，备案
    阿里云 备案地址：https://beian.aliyun.com/

2、购买服务器，阿里云，腾讯云，亚马逊云aws

3、配置域名解析到服务器
</code></pre><p>​    </p>
<p>​<br>第十二章 微服务必备技能Docker容器基础篇幅<br>​<br>​    1、微服务下的Docker介绍和使用场景<br>​        简介：Docker介绍和使用场景<br>​<br>​        1、什么是Dokcer<br>​            百科:一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口；<br>​<br>​            使用go语言编写，在LCX（linux容器）基础上进行的封装<br>​<br>​            简单来说：<br>​                1）就是可以快速部署启动应用<br>​                2）实现虚拟化，完整资源隔离<br>​                3）一次编写，四处运行（有一定的限制，比如Docker是基于Linux 64bit的，无法在32bit的linux/Windows/unix环境下使用）<br>​<br>​        2、为什么要用<br>​            1、提供一次性的环境，假如需要安装Mysql，则需要安装很多依赖库、版本等，如果使用Docker则通过镜像就可以直接启动运行<br>​<br>            2、快速动态扩容，使用docker部署了一个应用，可以制作成镜像，然后通过Dokcer快速启动</p>
<pre><code>        3、组建微服务架构，可以在一个机器上模拟出多个微服务，启动多个应用

        4、更好的资源隔离和共享

        一句话：开箱即用，快速部署，可移植性强，环境隔离







2、Linux云服务器Centos7安装Docker实战
    简介：讲解阿里云ECS服务安装Docker实战
    Linux Standard Base的缩写，lsb_release命令用来显示LSB和特定版本的相关信息
    命令： lsb_release -a 

    阿里云安装手册：
    https://help.aliyun.com/document_detail/51853.html?spm=a2c4g.11186623.6.820.RaToNY

    常见问题：
    https://blog.csdn.net/daluguishou/article/details/52080250






3、Docker仓库、镜像、容器核心知识讲解
    简介：快速掌握Dokcer基础知识，

    1、概念：
        Docker 镜像 - Docker images：
                 容器运行时的只读模板，操作系统+软件运行环境+用户程序

                 class User{
                     private String userName;
                     private int age;
                 }


        Docker 容器 - Docker containers：
                容器包含了某个应用运行所需要的全部环境

                 User user = new User()


        Docker 仓库 - Docker registeries： 
                用来保存镜像，有公有和私有仓库，好比Maven的中央仓库和本地私服
                镜像仓库：    

                （参考）配置国内镜像仓库：https://blog.csdn.net/zzy1078689276/article/details/77371782

        对比面向对象的方式
        Dokcer 里面的镜像 : Java里面的类 Class
        Docker 里面的容器 : Java里面的对象 Object
        通过类创建对象，通过镜像创建容器


4、Docker容器常见命令实战
    简介：讲解Docker在云服务上的实际应用
    1、 常用命令（安装部署好Dokcer后，执行的命令是docker开头）,xxx是镜像名称

        搜索镜像：docker search xxx

        列出当前系统存在的镜像：docker images

        拉取镜像：docker pull xxx
            xxx是具体某个镜像名称(格式 REPOSITORY:TAG)
            REPOSITORY：表示镜像的仓库源,TAG：镜像的标签

        运行一个容器：docker run -d --name &quot;xdclass_mq&quot; -p 5672:5672 -p 15672:15672 rabbitmq:management
            docker run - 运行一个容器
            -d 后台运行
            -p 端口映射
            rabbitmq:management  (格式 REPOSITORY:TAG)，如果不指定tag，默认使用最新的
            --name &quot;xxx&quot;

        列举当前运行的容器：docker ps

        检查容器内部信息：docker inspect 容器名称

        删除镜像：docker rmi IMAGE_NAME
             强制移除镜像不管是否有容器使用该镜像 增加 -f 参数，

        停止某个容器：docker stop 容器名称

        启动某个容器：docker start 容器名称

        移除某个容器： docker rm 容器名称 （容器必须是停止状态）


    文档：
        https://blog.csdn.net/permike/article/details/51879578







5、实战应用之使用Docker部署Nginx服务器
    简介：讲解使用Docker部署Nginx服务器实战
    1、获取镜像 
        docker run (首先会从本地找镜像，如果有则直接启动，没有的话，从镜像仓库拉起，再启动)

        docker search nignx
    2、列举
        docker images
    3、拉取
        docker pull nignx
    3、启动
        docker run -d --name &quot;xdclass_nginx&quot; -p 8088:80 nginx
        docker run -d --name &quot;xdclass_nginx2&quot; -p 8089:80 nginx
        docker run -d --name &quot;xdclass_nginx3&quot; -p 8090:80 nginx
    4、访问
        如果是阿里云服务，记得配置安全组，腾讯云也需要配置，这个就是一个防火墙







6、公司中Docker镜像仓库使用讲解
    简介：讲解一般公司中镜像仓库在的使用

    1、为啥要用镜像仓库


    2、官方公共镜像仓库和私有镜像仓库
        公共镜像仓库：
                官方：https://hub.docker.com/，基于各个软件开发或者有软件提供商开发的
                非官方：其他组织或者公司开发的镜像，供大家免费试用

        私有镜像仓库：
                用于存放公司内部的镜像，不提供给外部试用； 

                SpringCloud 开发了一个支付系统 -》做成一个镜像 （操作系统+软件运行环境+用户程序）






7、高级篇幅之构建自己的镜像仓库
    简介：使用阿里云搭建自己的镜像仓库

    1、阿里云镜像仓库：https://dev.aliyun.com/search.html

    点击管理控制台-》初次使用会提示开通，然后设置密码
    xdclass.net123


    2、使用阿里云私有镜像仓库
        1)登录： docker login --username=794666918@qq.com registry.cn-shenzhen.aliyuncs.com

        2) 推送本地镜像：
        docker tag [ImageId] registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:[镜像版本号]
        例子：
        docker tag 2f415b0e9a6e registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:xd_rabbitmq-v1.0.2

        docker push registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:xd_rabbitmq-v1.0.2

        3)拉取镜像
            线上服务器拉取镜像：
                docker login --username=794666918@qq.com registry.cn-shenzhen.aliyuncs.com

                docker pull registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:xd_rabbitmq-v1.0.2

                启动容器：
                docker run -d --name &quot;xdclass_mq&quot; -p 5672:5672 -p 15672:15672 2f415b0e9a6e
</code></pre><p>第十三章 微服务高级篇幅SpringCloud和Docker整合部署<br>​<br>​    第1课 高级篇幅之构建SpringBoot应用docker镜像上集<br>​<br>​    简介:使用Docker的maven插件，构建springboot应用<br>​<br>    官方文档：<a href="https://spring.io/guides/gs/spring-boot-docker/" target="_blank" rel="noopener">https://spring.io/guides/gs/spring-boot-docker/</a></p>
<pre><code>1、步骤：maven里面添加配置pom.xml

     &lt;properties&gt;
       &lt;docker.image.prefix&gt;xdclass&lt;/docker.image.prefix&gt;
    &lt;/properties&gt;

    &lt;build&gt;
        &lt;finalName&gt;docker-demo&lt;/finalName&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;com.spotify&lt;/groupId&gt;
                &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;1.3.6&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;repository&gt;${docker.image.prefix}/${project.artifactId}&lt;/repository&gt;
                    &lt;buildArgs&gt;
                        &lt;JAR_FILE&gt;target/${project.build.finalName}.jar&lt;/JAR_FILE&gt;
                    &lt;/buildArgs&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    配置讲解
    Spotify 的 docker-maven-plugin 插件是用maven插件方式构建docker镜像的。
    ${project.build.finalName} 产出物名称，缺省为${project.artifactId}-${project.version}
</code></pre><p>=============================================<br>更多干货技术访问小D课堂官网 <a href="https://xdclass.net" target="_blank" rel="noopener">https://xdclass.net</a><br>小D老师个人微信：jack794666918</p>
<h1 id="公众号搜索：小D课堂-1"><a href="#公众号搜索：小D课堂-1" class="headerlink" title="公众号搜索：小D课堂"></a>公众号搜索：小D课堂</h1><pre><code>第2课 高级篇幅之构建SpringBoot应用docker镜像下集

        简介:打包SpringCloud镜像并上传私有仓库并部署

        1、创建Dockerfile,默认是根目录，（可以修改为src/main/docker/Dockerfile,如果修则需要制定路径）
            什么是Dockerfile : 由一系列命令和参数构成的脚本，这些命令应用于基础镜像, 最终创建一个新的镜像

            FROM openjdk:8-jdk-alpine
            VOLUME /tmp
            ARG JAR_FILE
            COPY ${JAR_FILE} app.jar
            ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]


            参数讲解：
            FROM &lt;image&gt;:&lt;tag&gt; 需要一个基础镜像，可以是公共的或者是私有的， 后续构建会基于此镜像，如果同一个Dockerfile中建立多个镜像时，可以使用多个FROM指令

            VOLUME  配置一个具有持久化功能的目录，主机 /var/lib/docker 目录下创建了一个临时文件，并链接到容器的/tmp。改步骤是可选的，如果涉及到文件系统的应用就很有必要了。/tmp目录用来持久化到 Docker 数据文件夹，因为 Spring Boot 使用的内嵌 Tomcat 容器默认使用/tmp作为工作目录 

            ARG  设置编译镜像时加入的参数， ENV 是设置容器的环境变量
            COPY : 只支持将本地文件复制到容器 ,还有个ADD更强大但复杂点
            ENTRYPOINT 容器启动时执行的命令
            EXPOSE 8080 暴露镜像端口
        2、构建镜像
        mvn install dockerfile:build
        打标签
        docker tag a1b9fc71720d registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:docker-demo-v201808
        推送到镜像仓库
        docker push registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:docker-demo-v201808

        应用服务器拉取镜像
        docker pull registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:docker-demo-v201808


        docker run -d --name xdclass_docker_demo1 -p 8099:8080  a1b9fc71720d

        3、查看启动日志 docker logs -f  containerid

        文档：https://yeasy.gitbooks.io/docker_practice/image/dockerfile/











第3课 实战系列之注册中心打包Docker镜像
    简介：讲解使用Docker打包注册中心，上传私有镜像仓库并部署

    1、新增maven插件
        &lt;properties&gt;
           &lt;docker.image.prefix&gt;xdclass&lt;/docker.image.prefix&gt;
        &lt;/properties&gt;

        &lt;build&gt;
            &lt;finalName&gt;docker-demo&lt;/finalName&gt;
            &lt;plugins&gt;
                &lt;plugin&gt;
                    &lt;groupId&gt;com.spotify&lt;/groupId&gt;
                    &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt;
                    &lt;version&gt;1.3.6&lt;/version&gt;
                    &lt;configuration&gt;
                        &lt;repository&gt;${docker.image.prefix}/${project.artifactId}&lt;/repository&gt;
                        &lt;buildArgs&gt;
                            &lt;JAR_FILE&gt;target/${project.build.finalName}.jar&lt;/JAR_FILE&gt;
                        &lt;/buildArgs&gt;
                    &lt;/configuration&gt;
                &lt;/plugin&gt;
            &lt;/plugins&gt;
        &lt;/build&gt;

    2、新建Dockerfile
            FROM openjdk:8-jdk-alpine
            VOLUME /tmp
            ARG JAR_FILE
            COPY ${JAR_FILE} app.jar
            ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]

    3、打包：
        mvn install dockerfile:build

    4、推送阿里云镜像仓库

    阿里云镜像仓库：https://dev.aliyun.com/search.html
</code></pre><p>docker tag 062d2ddf272a registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:eureka-v20180825<br>docker push registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:eureka-v20180825<br>docker pull registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:eureka-v20180825</p>
<pre><code>    5、查看日志 docker logs -f  containerid






第4课 实战系列之部署RabbitMQ和配置中心打包Docker镜像
    简介：讲解使用Docker打包配置中心，和部署RabbitMQ

    1、服务地址 ssh root@47.106.120.173

    部署    rabbitmq： docker run -d -p 5672:5672 -p 15672:15672 rabbitmq:management

    2、推送镜像

    docker tag 0f636543904e registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:config-server-v20180825

    docker push registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:config-server-v20180825

    docker pull registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:config-server-v20180825



5、常见问题处理之升级云服务器
    简介：处理上节课出现的问题，升级服务器注意事项

    1、升级云服务器配置（购买配置后需要重启机器才生效）

    2、启动完成后，需要开启docker
        指令： systemctl  start docker

    3、所有对外的都要经过网关才可以对外，应用间通信(除非跨机房)都用内网通信









6、实战系列之Docker部署Redis
    简介：使用Docker安装redis
    1、搜索镜像 docker search redis

    2、拉取 docker pull docker.io/redis

    3、启动 docker run --name &quot;xd_redis&quot; -p 6379:6379 -d 4e8db158f18d
    参考：
    docker run --name &quot;xd_redis&quot; -p 6379:6379 -d 4e8db158f18d --requirepass &quot;123456&quot; -v $PWD/data:/data

    4、访问redis容器里面，进行操作
    docker exec -it 295058d2b92e redis-cli










7、生产环境常见问题之配置中心访问
    简介：讲解生产环境部署常见问题，配置中心访问路径变化

    1、配置中心访问出错，路径不对

       解决：修改所有的注册中心，增加下面配置
    instance:
    instance-id: ${spring.cloud.client.ip-address}:${server.port}
    prefer-ip-address: true



    docker tag 50a12cd66210 registry.cn-shenzhen.aliyuncs.com/xdclass/xdclass_images:config-server-v20180826








8、实战系列之打包Docker镜像打包商品服务和订单服务、网关 
   简介:打包Docker镜像部署商品服务和订单服务、网关

   注意：
   1、maven打包构建，会触发单元测试，部分情况可以跳过，
   mvn install -Dmaven.test.skip=true dockerfile:build

   2、生产环境不能用localhost 或者 127.0.0.1, 一定要用内网通信ip (虚拟主机映射 hosts)










 9、实战系列云服务器部署网关、订单、商品服务
     简介：云服务部署商品服务、订单服务、网关服务

     1、拉取镜像、启动



     访问路径
     http://47.106.120.173:8781/api/v1/order/save?product_id=5&amp;user_id=5

     http://47.106.120.173:9000/apigateway/order/api/v1/order/save?user_id=5&amp;product_id=3&amp;token=232serer
</code></pre><p>第十四章 课程总结和常见问题处理</p>
<pre><code>1、SpringCloud微服务常见问题和解决思路
简介：讲解SpringCloud开发实战常见问题，及解决思路

    1、技术选择：SpringCloud全家桶，每个组件又有多个替代，改怎么选择

        1）选择的时候根据公司里面团队人员熟悉程度，降低学习成本
        2）选择社区活跃的并且文档相对较多的，怎么判断活跃，可以看github上代码提交和start数

    2、云服务选择： 腾讯云，阿里云 ，遇到问题可以提交工单，有专人跟进
</code></pre><p>​<br>​        3、部署了应用，但是访问不了<br>​            解决思路：<br>​                1)查看应用启动是否正常，如果有错误日志，复制错误日志去百度搜索！！！！！！！特别重要<br>​<br>​                2）启动正常，则先在本机使用 CURL “<a href="http://lcoalhost:8080/api/v1/user/find&quot;" target="_blank" rel="noopener">http://lcoalhost:8080/api/v1/user/find&quot;</a>  访问对应的接口，看是否有响应<br>​<br>​                3）启动正常，且curl有响应，则检查是否有关闭防火墙，或者开放对应的访问端口，开放端口才可以访问<br>​<br>​                4）腾讯云和阿里云都是有安全组，类似外层防火墙，一定要去web控制台检查是否有开启端口</p>
<pre><code>    4、内网和外网访问，鉴权问题安全问题

            1）所有应用只能通过网关提供对外访问的入口

            2）应用程序之间通讯，采用内网


    5、程序出错或者异常: 复制错误日志去百度搜索，网上有很多人会遇到类似的错误，多积累，特别强调







2、课程总结和后续技术规划
简介：总结SpringCloud课程和微服务后续课程规划

    1、springCloud全家桶，技术选择和知识点特别多，一定要学会记笔记，微服务更多关注的是里面架构和数据流转，而不是具体的业务。

    2、SpringCloud架构这些配置，一般使用一次后就不会多次修改了，进入公司主要还是开发业务，业务开发一般都用springboot，比较少让新人搭建SpringCloud的架构


    3、开发业务，无非就是CRUD，增删改查，只不过是初级和高级的区别，封装成通用和不通用的区别
</code></pre><p>​<br>​        4、微服务和容器盛行的情况下，容器编排和自动缩扩容越来越重要<br>​<br>​            可以关注：k8s / service mesh /server less 等技术</p>
<p>​<br>​        总结：<br>​            1）后续会推出对应的课程，还有项目实战系列，大家记得关注 小D课堂，官网 ：<a href="https://xdclass.net" target="_blank" rel="noopener">https://xdclass.net</a>,<br>​<br>​            2）也可以加我微信交流： jack794666918<br>​<br>​            3）购买对应的课程后，记得进我们小D课堂官方的交流群，我会在里面分享主流技术和答疑，面试经验等等，还会同步更新资料和还超级干货分享 </p>
<p>=============================================</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/09/开发遇到的问题/常见问题总结/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/09/开发遇到的问题/常见问题总结/" itemprop="url">常见问题总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-09T17:14:16+08:00">
                2018-11-09
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/09/开发遇到的问题/常见问题总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/09/开发遇到的问题/常见问题总结/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>前端向后端传值：</p>
<ul>
<li><p>Button 和form</p>
</li>
<li><ul>
<li><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">goUpdatePage</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.location.href = <span class="string">"$&#123;pageContext.request.contextPath&#125;/user/editcontroller?id="</span> + id;</span><br><span class="line">&#125;      </span><br><span class="line"> &lt;button type=<span class="string">"button"</span> onclick=<span class="string">"goUpdatePage($&#123;user.id&#125;)"</span></span><br><span class="line">        <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-primary btn-xs"</span>&gt;</span><br><span class="line">    &lt;i</span><br><span class="line">            <span class="class"><span class="keyword">class</span></span>=<span class="string">" glyphicon glyphicon-pencil"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>开发中service层 必须要写 @service注解</p>
</li>
<li><p>⚠️service中不要加@service。在service的实现serviceiml中加@service注解</p>
</li>
<li><p>开发的顺序 从前端传值到Controller 再到 service 再到serviceimpl 再到userdao 再到mybatis.xml再到数据库 数据库返回前端页面</p>
</li>
<li><p>引入mybatis 的多个mapper的配置文件 mapper.xml  Spring Boot 的方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mybatis.mapper-locations=classpath:mybatis/mapper/*.xml</span><br></pre></td></tr></table></figure>
</li>
<li><p>###idea警告：Field injection is not recommended</p>
</li>
<li><p>####Springboot开发 Dao中UserDao RoleDao中要加 @Mapper注解</p>
<p># </p>
</li>
<li><h1 id=""><a href="#" class="headerlink" title=""></a><img src="/Users/apple/Desktop/屏幕快照 2018-11-14 下午1.19.50.png" alt="屏幕快照 2018-11-14 下午1.19.50"></h1></li>
<li><p>import和open项目是不一样的 出现上面的情况要import一下啊 兄ide</p>
</li>
<li><h3 id="Caused-by-org-apache-ibatis-type-TypeException-Could-not-resolve-type-alias-‘BaseResultMap’"><a href="#Caused-by-org-apache-ibatis-type-TypeException-Could-not-resolve-type-alias-‘BaseResultMap’" class="headerlink" title="Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias ‘BaseResultMap’"></a>Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias ‘BaseResultMap’</h3></li>
<li><p>Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Ca</p>
<blockquote>
<p> 看到那个<strong>resultType</strong>了么，就是它惹的祸，这里把<strong>resultType</strong>改为<strong>resultMap</strong>就OK啦，重启tomcat，木有异常啦</p>
</blockquote>
</li>
</ul>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023014.jpg" alt="image-20181114135152950"></p>
<blockquote>
<p>跳转视图 用字符串哈 </p>
</blockquote>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023015.jpg" alt="image-20181117115951176"></p>
<p>开发中前端的img要放到和框架的同一目录及下面哈。兄die</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection connection = ConnectionUtils.getConnection();</span><br></pre></td></tr></table></figure>
<p>用类.方法（）.var 可以直接返回该对象的返回对象</p>
<p>Sting s=”test”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(s);===s.sout</span><br></pre></td></tr></table></figure>
<p><img src="../../../../Users/apple/Library/Application Support/typora-user-images/image-20190131103713601.png" alt="image-20190131103713601"></p>
<hr>
<h1 id="时间问题"><a href="#时间问题" class="headerlink" title="时间问题"></a>时间问题</h1><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023016.jpg" alt="image-20190209160806502"></p>
<blockquote>
<p><a href="https://blog.csdn.net/qq_34160679/article/details/80651027" target="_blank" rel="noopener">https://blog.csdn.net/qq_34160679/article/details/80651027</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc.url     = jdbc:mysql:/xxx:3306/zhongfubang?useUnicode=true&amp;characterEncoding=UTF-8&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=Asia/Shanghai</span><br></pre></td></tr></table></figure>
<h1 id="Linux-无法使用命令"><a href="#Linux-无法使用命令" class="headerlink" title="Linux 无法使用命令"></a>Linux 无法使用命令</h1><h2 id="export-PATH-usr-local-sbin-usr-local-bin-sbin-bin-usr-sbin-usr-bin-root-bin"><a href="#export-PATH-usr-local-sbin-usr-local-bin-sbin-bin-usr-sbin-usr-bin-root-bin" class="headerlink" title="export PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin"></a>export PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</h2><p>修改/etc/profile文件，配置maven环境变量时候出问题了，忘记加了 $PATH: 然后source /etc/profile 接下来就是 ll,ls,vim命令都用不了。。。害的我以为<a href="https://www.baidu.com/s?wd=xshell&amp;tn=24004469_oem_dg&amp;rsv_dl=gh_pl_sl_csd" target="_blank" rel="noopener">xshell</a>我更新了呢，卸载重装了还是没用。</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023017.png" alt="img"></p>
<p>解决办法如下图，执行这两条命令：</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-23020.jpg" alt="img"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line"> </span><br><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure>
<h1 id="SpringBoot-主类报错"><a href="#SpringBoot-主类报错" class="headerlink" title="SpringBoot 主类报错"></a>SpringBoot 主类报错</h1><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-23022.jpg" alt="image-20190302154936111"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在idea中使用终端 然后使用mvn install命令。删掉有问题的jar包重新下载。 解决问题</span><br></pre></td></tr></table></figure>
<h1 id="Idea相关"><a href="#Idea相关" class="headerlink" title="Idea相关"></a>Idea相关</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">装一个lombok插件才会有get set方法</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MybatisPluginCodes插件</span><br><span class="line">  findBy...</span><br><span class="line">  看文档 卸载其他相关插件</span><br><span class="line">  commond+1 创建SQl语句</span><br></pre></td></tr></table></figure>
<h1 id="self4j-log4j的问题"><a href="#self4j-log4j的问题" class="headerlink" title="self4j log4j的问题"></a>self4j log4j的问题</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggerFactory is not a Logback LoggerContext but Logback is on the classpath. Either remove Logback or the competing implementation</span><br></pre></td></tr></table></figure>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023024.jpg" alt="image-20190313123221966"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">        &lt;exclusions&gt;</span><br><span class="line">                &lt;exclusion&gt;</span><br><span class="line">                    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class="line">                   &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</span><br><span class="line">                &lt;/exclusion&gt;</span><br><span class="line">           &lt;/exclusions&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">---------------------</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Springboot-依赖冲突"><a href="#Springboot-依赖冲突" class="headerlink" title="Springboot 依赖冲突"></a>Springboot 依赖冲突</h1><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023025.jpg" alt="image-20190313141644871"></p>
<hr>
<h2 id="Maven-logs遇到错误-重启Idea-或者关机重启电脑"><a href="#Maven-logs遇到错误-重启Idea-或者关机重启电脑" class="headerlink" title="Maven logs遇到错误 重启Idea 或者关机重启电脑"></a>Maven logs遇到错误 重启Idea 或者关机重启电脑</h2><hr>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023027.jpg" alt="image-20190315181918906"></p>
<hr>
<h1 id="SpringBoot-Mybatis-整合问题："><a href="#SpringBoot-Mybatis-整合问题：" class="headerlink" title="SpringBoot +Mybatis 整合问题："></a>SpringBoot +Mybatis 整合问题：</h1><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023029.jpg" alt="image-20190315184317660"></p>
<p>使用Yml 添加mapperxml</p>
<h1 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023030.jpg" alt="image-20190315184344150"></h1><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line"> @ResponseBody</span><br><span class="line"> public Mydb01 list(@PathVariable(&quot;id&quot;) Integer id) &#123;//@PathVariable(&quot;id&quot;)  id是不是一定要写</span><br><span class="line">     return userService.selectByPrimaryKey(id);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023032.jpg" alt="image-20190315184418672"></p>
<hr>
<h1 id="maven-pom-文件"><a href="#maven-pom-文件" class="headerlink" title="maven pom 文件"></a>maven pom 文件</h1><h1 id="-2"><a href="#-2" class="headerlink" title=""></a><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023034.jpg" alt="image-20190422100555253"></h1><hr>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023036.jpg" alt="image-20190422100619170"></p>
<hr>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-023038.jpg" alt="image-20190422100653173"></p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/09/开发遇到的问题/Iterm2配置/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/09/开发遇到的问题/Iterm2配置/" itemprop="url">ITerm2的配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-09T09:58:44+08:00">
                2018-11-09
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/09/开发遇到的问题/Iterm2配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/09/开发遇到的问题/Iterm2配置/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ITerm2的配置问题"><a href="#ITerm2的配置问题" class="headerlink" title="ITerm2的配置问题"></a>ITerm2的配置问题</h2><h1 id="每次vim的时候一定要source一下-啊-xiong-die"><a href="#每次vim的时候一定要source一下-啊-xiong-die" class="headerlink" title="每次vim的时候一定要source一下 啊 xiong die"></a>每次vim的时候一定要source一下 啊 xiong die</h1><blockquote>
<p>学习资源</p>
<p><a href="https://www.jianshu.com/p/9c3439cc3bdb" target="_blank" rel="noopener">https://www.jianshu.com/p/9c3439cc3bdb</a> 简书</p>
<p><a href="https://github.com/sirius1024/iterm2-with-oh-my-zsh" target="_blank" rel="noopener">https://github.com/sirius1024/iterm2-with-oh-my-zsh</a> Github</p>
<p><a href="https://www.cnblogs.com/xishuai/p/mac-iterm2.html" target="_blank" rel="noopener">https://www.cnblogs.com/xishuai/p/mac-iterm2.html</a> 博客园</p>
<p><a href="https://blog.csdn.net/z3512498/article/details/51245853" target="_blank" rel="noopener">https://blog.csdn.net/z3512498/article/details/51245853</a> CSDN 改变用户名 </p>
<blockquote>
<p>必须要使用vim的命令修改配置</p>
</blockquote>
</blockquote>
<h3 id="常见的命令"><a href="#常见的命令" class="headerlink" title="常见的命令"></a>常见的命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.zshrc</span><br><span class="line">source ~/.zshrc  （soucre配置文件 让配置文件生效）</span><br><span class="line">文件放在itermgit下面 必须要在主题可以使用的情况下 进行以上的配置</span><br><span class="line">快捷键冲突 取词 copy失效</span><br></pre></td></tr></table></figure>
<h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><ul>
<li>安装完成后，在/bin目录下会多出一个zsh的文件。</li>
</ul>
<p>Mac系统默认使用dash作为终端，可以使用命令修改默认使用zsh：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<p>如果想修改回默认dash，同样使用chsh命令即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chsh -s /bin/bash</span><br></pre></td></tr></table></figure>
<p>export MAVEN_HOME=/Java/apache-maven-3.5.4 </p>
<p>export PATH=${PATH}:${MAVEN_HOME}/bin </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/08/Docker/Docker-web/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/08/Docker/Docker-web/" itemprop="url">docker-web</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-08T10:20:30+08:00">
                2018-11-08
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/08/Docker/Docker-web/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/08/Docker/Docker-web/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p> 学习地址* <a href="https://www.imooc.com/video/14624（慕课网）-6⃣刘果国" target="_blank" rel="noopener">https://www.imooc.com/video/14624（慕课网）-6⃣刘果国</a></p>
</blockquote>
<p>#第一个 java web项目 （SpringBoot 项目打包成一个war包的方式）</p>
<h3 id="一制作自己的景象"><a href="#一制作自己的景象" class="headerlink" title="一制作自己的景象"></a>一制作自己的景象</h3><ul>
<li><p>Dockerfile</p>
</li>
<li><p>docker build</p>
<hr>
<ul>
<li>首先需要一个war文件 拷贝在桌面上</li>
</ul>
<blockquote>
<p>Docker images</p>
</blockquote>
</li>
</ul>
<h5 id="1-建立一个Dockerfile"><a href="#1-建立一个Dockerfile" class="headerlink" title="1.建立一个Dockerfile"></a>1.建立一个Dockerfile</h5><blockquote>
<p>vim Dockerfile</p>
</blockquote>
<h6 id="2-下载Tomcat镜像"><a href="#2-下载Tomcat镜像" class="headerlink" title="2. 下载Tomcat镜像"></a>2. 下载Tomcat镜像</h6><blockquote>
<p>网易镜像中心 找Tomcat的镜像 <a href="https://c.163yun.com/hub#/m/home/" target="_blank" rel="noopener">https://c.163yun.com/hub#/m/home/</a></p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-22404.jpg" alt="image-20181108171728002"></p>
</blockquote>
<p>（包括JDK Tomcat）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull hub.c.163.com/library/tomcat:latest</span><br></pre></td></tr></table></figure>
<p> <img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022405.jpg" alt="image-20181108172737831"></p>
<p>站在巨人的肩上</p>
<h5 id="3-编辑Dockerfile"><a href="#3-编辑Dockerfile" class="headerlink" title="3.编辑Dockerfile"></a>3.编辑Dockerfile</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在Mac终端中使用vim编辑文件步骤</span><br><span class="line">1.  cd   文件所在的文件夹路径  &lt;回車&gt;</span><br><span class="line">2. 輸入  vim 文件名 &lt;回車&gt;</span><br><span class="line">3. 按下 i 鍵來编辑文本文字</span><br><span class="line">4. 退出vim編輯器：</span><br><span class="line">     不保存并退出  &lt;ESC&gt;   :q!   &lt;回車&gt;</span><br><span class="line">     保存并退出     &lt;ESC&gt;   :wq   &lt;回車&gt;</span><br></pre></td></tr></table></figure>
<p>from hub.c.163.com/library/tomcat</p>
<p>MAINTAINER Freemana2017 <a href="mailto:1047629166@qq.com" target="_blank" rel="noopener">1047629166@qq.com</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /Users/apple/Desktop/Dockerweb</span><br><span class="line">ls</span><br><span class="line">&gt; mv atcrodfunding3_ssm-0.0.1-SNAPSHOT.war atcrod.war</span><br><span class="line">mv atcrodfunding3_ssm-0.0.1-SNAPSHOT.war atcrod.war (用MV 重新命名一下)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>进入文件夹里面 编写Dockerfile</p>
</li>
<li><p>学会看镜像的说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">How to use this image.</span><br><span class="line"></span><br><span class="line">Run the default Tomcat server (CMD [\&quot;catalina.sh\&quot;, \&quot;run\&quot;]):</span><br><span class="line"></span><br><span class="line">$ docker run -it --rm tomcat:8.0</span><br><span class="line">You can test it by visiting http://container-ip:8080 in a browser or, if you need access outside the host, on port 8888:</span><br><span class="line"></span><br><span class="line">$ docker run -it --rm -p 8888:8080 tomcat:8.0</span><br><span class="line">You can then go to http://localhost:8888 or http://host-ip:8888 in a browser.</span><br><span class="line"></span><br><span class="line">The default Tomcat environment in the image for versions 7 and 8 is:</span><br><span class="line"></span><br><span class="line">⭐️CATALINA_BASE:   /usr/local/tomcat</span><br><span class="line">⭐️CATALINA_HOME:   /usr/local/tomcat</span><br><span class="line">CATALINA_TMPDIR: /usr/local/tomcat/temp</span><br><span class="line">JRE_HOME:        /usr</span><br><span class="line">CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="1。编写Dockerfile-文件–Dockerfile"><a href="#1。编写Dockerfile-文件–Dockerfile" class="headerlink" title="1。编写Dockerfile 文件–Dockerfile"></a>1。编写Dockerfile 文件–Dockerfile</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from hub.c.163.com/library/tomcat</span><br><span class="line"></span><br><span class="line">MAINTAINER Freemana2017 1047629166@qq.com</span><br><span class="line"></span><br><span class="line">COPY atcrod.war /usr/local/tomcat/webapps</span><br></pre></td></tr></table></figure>
<h3 id="2-创建镜像-–docker-build"><a href="#2-创建镜像-–docker-build" class="headerlink" title="2.创建镜像 –docker build"></a>2.创建镜像 –docker build</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-22408.jpg" alt="image-20181108174858497"></p>
<h3 id="3-查看镜像–docker-images"><a href="#3-查看镜像–docker-images" class="headerlink" title="3.查看镜像–docker images"></a>3.查看镜像–docker images</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022408.jpg" alt="image-20181108174929561"></p>
<h2 id="4-给镜像写名字-docker-build-t-atcrod-latest"><a href="#4-给镜像写名字-docker-build-t-atcrod-latest" class="headerlink" title="4.给镜像写名字 docker build -t atcrod:latest ."></a>4.给镜像写名字 docker build -t atcrod:latest .</h2><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022409.jpg" alt="image-20181108175158795"></p>
<h3 id="5-再次查看镜像-docker-images"><a href="#5-再次查看镜像-docker-images" class="headerlink" title="5.再次查看镜像 docker images"></a>5.再次查看镜像 docker images</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022411.jpg" alt="image-20181108175309803"></p>
<hr>
<hr>
<hr>
<hr>
<h1 id="二运行自己的容器"><a href="#二运行自己的容器" class="headerlink" title="###二运行自己的容器"></a>###二运行自己的容器</h1><h3 id="1-docker-run-d-p-8888-8080-atcrod"><a href="#1-docker-run-d-p-8888-8080-atcrod" class="headerlink" title="1.docker run -d -p 8888:8080 atcrod"></a>1.docker run -d -p 8888:8080 atcrod</h3><blockquote>
<p>8888本机的端口号。8080Tomcat的端口号 去163.com查询 atcrod镜像的名字</p>
</blockquote>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022413.jpg" alt="image-20181108175738036"></p>
<h4 id="2-docker-ps"><a href="#2-docker-ps" class="headerlink" title="2.docker ps"></a>2.docker ps</h4><blockquote>
<p>查看Tomcat的进程 检查容器是不是启动啦</p>
</blockquote>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-22416.jpg" alt="image-20181108175751244"></p>
<h3 id="3-netstat-na-grep-8888"><a href="#3-netstat-na-grep-8888" class="headerlink" title="3.netstat -na|grep 8888"></a>3.netstat -na|grep 8888</h3><blockquote>
<p>检查端口是不是存在了  输入localhost:8888测试Tomcat是否启动啦</p>
</blockquote>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022418.jpg" alt="image-20181108180034419"></p>
<hr>
<hr>
<hr>
<hr>
<hr>
<h1 id="⚠️-以上只是web项目在Docker中的部署项目"><a href="#⚠️-以上只是web项目在Docker中的部署项目" class="headerlink" title="⚠️ 以上只是web项目在Docker中的部署项目"></a>⚠️ 以上只是web项目在Docker中的部署项目</h1><h1 id="3-Docker-部署SpringBoot-web项目"><a href="#3-Docker-部署SpringBoot-web项目" class="headerlink" title="3.Docker 部署SpringBoot web项目"></a>3.Docker 部署SpringBoot web项目</h1><blockquote>
<p>学习资源汇总</p>
<p><a href="http://www.ityouknow.com/springboot/2018/03/19/spring-boot-docker.html" target="_blank" rel="noopener">http://www.ityouknow.com/springboot/2018/03/19/spring-boot-docker.html</a></p>
<p><a href="https://blog.csdn.net/weixin_39800144/article/details/79214978" target="_blank" rel="noopener">https://blog.csdn.net/weixin_39800144/article/details/79214978</a></p>
<p><a href="https://blog.csdn.net/weixin_39800144/article/details/79213276" target="_blank" rel="noopener">https://blog.csdn.net/weixin_39800144/article/details/79213276</a></p>
<p><a href="https://bingohuang.com/spring-boot-docker/" target="_blank" rel="noopener">https://bingohuang.com/spring-boot-docker/</a></p>
</blockquote>
<blockquote>
<p>FROM java:8</p>
<p>VOLUME /tmp</p>
<p>COPY target/tran4spd-1.0-SNAPSHOT.jar resource.jar.   #这边放的是Docker部署的jar包的位置 绝对路径</p>
<p>RUN bash -c “touch /resource.jar”</p>
<p>EXPOSE 8080</p>
<p>ENTRYPOINT [“java”,”-jar”,”resource.jar”]</p>
<p># docker run -d -p 18080:8099 –name docker-resource leesia/resource:1.0</p>
</blockquote>
<p> 注意java-jar无法运行Tomcat要外置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/javax.servlet/servlet-api --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.5&lt;/version&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>##文件路径不要用中文！！！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/07/Docker/Docker-SpringBoot/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="袁海鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Freemana2017">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/07/Docker/Docker-SpringBoot/" itemprop="url">Docker SpringBoot</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-07T18:04:37+08:00">
                2018-11-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/SpringBoot/" itemprop="url" rel="index">
                    <span itemprop="name">SpringBoot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/07/Docker/Docker-SpringBoot/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/11/07/Docker/Docker-SpringBoot/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="DockerMachine应用"><a href="#DockerMachine应用" class="headerlink" title="DockerMachine应用"></a>DockerMachine应用</h2><h4 id="注意整个过程要等待一下"><a href="#注意整个过程要等待一下" class="headerlink" title="注意整个过程要等待一下"></a>注意整个过程要等待一下</h4><blockquote>
<p>参考<a href="https://study.163.com/course/courseLearn.htm?courseId=1002892012#/learn/video?lessonId=1003309140&amp;courseId=1002892012" target="_blank" rel="noopener">https://study.163.com/course/courseLearn.htm?courseId=1002892012#/learn/video?lessonId=1003309140&amp;courseId=1002892012</a></p>
<p>网易云课堂 动手玩Docker</p>
</blockquote>
<ul>
<li>安装DockerMachine</li>
<li>docker-machine ls    tcp://192.168.99.100:2376   name：cloudcomb</li>
</ul>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022300.jpg" alt="image-20181107181833492"></p>
<ul>
<li><p>docker-machine create –driver virtualbox cloudcomb </p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022301.jpg" alt="image-20181107181903652"></p>
</li>
<li><p>Docker-machine env cloudcomb</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022303.jpg" alt="image-20181107182121568"></p>
</li>
</ul>
<p>⚠️第四个变量eval说的是当前Dockermachine的名字是—cloudcomb</p>
<ul>
<li><p>eval $(docker-machine env cloudcomb) 拷贝放到底下</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022305.jpg" alt="image-20181107182325486"></p>
</li>
<li><p>使用网易蜂巢</p>
</li>
<li><p>Docker run hub.c163.com/library/busybox:latest echon hello world （unable。。这个过程要等待啊）⭐️</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022306.jpg" alt="image-20181107182746194"></p>
</li>
<li><p>docker-machine rm cloudcomb 删除docker-machine</p>
</li>
</ul>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022308.jpg" alt="image-20181107182909832"></p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022309.jpg" alt="image-20181107183004383"></p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022310.jpg" alt="image-20181107183018420"></p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022313.jpg" alt="image-20181107183034881"></p>
<h1 id="SpringBoot整合Docker"><a href="#SpringBoot整合Docker" class="headerlink" title="SpringBoot整合Docker"></a>SpringBoot整合Docker</h1><blockquote>
<p>Emmmm.等我有钱了 把Xnip去掉哈哈</p>
</blockquote>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022315.jpg" alt="image-20181107183409783"></p>
<ul>
<li><p>下载源码<a href="https://github.com/bingohuang/spring-boot-docker" target="_blank" rel="noopener">https://github.com/bingohuang/spring-boot-docker</a></p>
<blockquote>
<p>Git 通过命令行下载文件 先cd一下指定一下下载的路径</p>
</blockquote>
</li>
<li><p>导入项目到Idea 然后查看一下源码</p>
</li>
<li><p>运行一下项目（访问一下 测试一下）</p>
<h2 id="Docker-SpringBoot部署项目"><a href="#Docker-SpringBoot部署项目" class="headerlink" title="Docker SpringBoot部署项目"></a>Docker SpringBoot部署项目</h2></li>
</ul>
<p>⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️⭐️</p>
<h3 id="1-install项目"><a href="#1-install项目" class="headerlink" title="1.install项目"></a>1.install项目</h3><p>  <img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022316.jpg" alt="image-20181107185602118"></p>
<blockquote>
<p>找到这两个文件 放到桌面上</p>
</blockquote>
<h3 id="2-将这两个项目放到一个文件下，不知道为什么好像要把jar改名成gs-spring-boot-docker-0-0-1-jar"><a href="#2-将这两个项目放到一个文件下，不知道为什么好像要把jar改名成gs-spring-boot-docker-0-0-1-jar" class="headerlink" title="2.将这两个项目放到一个文件下，不知道为什么好像要把jar改名成gs-spring-boot-docker-0.0.1.jar"></a>2.将这两个项目放到一个文件下，不知道为什么好像要把jar改名成gs-spring-boot-docker-0.0.1.jar</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022318.jpg" alt="image-20181107191351622"></p>
<h3 id="3-cd到文件下-ls一下"><a href="#3-cd到文件下-ls一下" class="headerlink" title="3.cd到文件下 ls一下"></a>3.cd到文件下 ls一下</h3><h3 id="4-执行-˛docker-version"><a href="#4-执行-˛docker-version" class="headerlink" title="4.执行  ˛docker version"></a>4.执行  ˛docker version</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022320.jpg" alt="image-20181107191444666"></p>
<h3 id="5-执行-docker-machine-env"><a href="#5-执行-docker-machine-env" class="headerlink" title="5.执行 docker-machine env"></a>5.执行 docker-machine env</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022322.jpg" alt="image-20181107191515590"></p>
<h3 id="6-执行eval-docker-machine-env-（复制后面的第四条）"><a href="#6-执行eval-docker-machine-env-（复制后面的第四条）" class="headerlink" title="6.执行eval $(docker-machine env)（复制后面的第四条）"></a>6.执行eval $(docker-machine env)（复制后面的第四条）</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022325.jpg" alt="image-20181107191547911"></p>
<p>tcp://192.168.99.100:2376192.168.99.100</p>
<p> tcp://127.0.0.1:2376 tcp://127.0.0.1:2376</p>
<p>###7.docker version（没有-）</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022326.jpg" alt="image-20181107191658043"></p>
<h3 id="8-ls一下目录"><a href="#8-ls一下目录" class="headerlink" title="8.ls一下目录"></a>8.ls一下目录</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-22329.jpg" alt="image-20181107191730046"></p>
<h3 id="9-docker-build-t-cloudcomb-sun-1-0"><a href="#9-docker-build-t-cloudcomb-sun-1-0" class="headerlink" title="9.docker build -t cloudcomb/sun:1.0 ."></a>9.docker build -t cloudcomb/sun:1.0 .</h3><blockquote>
<p> （桌面上要有jar包和dockerfilede 文件）</p>
</blockquote>
<p><img src="/Users/apple/Library/Application Support/typora-user-images/image-20181107191826890.png" alt="image-20181107191826890"></p>
<blockquote>
<p>此时报错 没有gs-spring-boot-docker.jar文件 其实ls的时候就应该是gs-spring-boot-docker.jar 这儿是个bug。</p>
<p>解决办法 改jar包名 添加gs前缀</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://docker.mirrors.ustc.edu.cn</span><br></pre></td></tr></table></figure>
<h3 id="10。docker-build-t-cloudcomb-sun-1-0-（大佬说这一步是拉取镜像。用加速器-改名后重新执行命令）我们可以用大佬网易云的Dokcer镜像"><a href="#10。docker-build-t-cloudcomb-sun-1-0-（大佬说这一步是拉取镜像。用加速器-改名后重新执行命令）我们可以用大佬网易云的Dokcer镜像" class="headerlink" title="10。docker build -t cloudcomb/sun:1.0 .（大佬说这一步是拉取镜像。用加速器 改名后重新执行命令）我们可以用大佬网易云的Dokcer镜像"></a>10。docker build -t cloudcomb/sun:1.0 .（大佬说这一步是拉取镜像。用加速器 改名后重新执行命令）我们可以用大佬网易云的Dokcer镜像</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022330.jpg" alt="image-20181107192039326"></p>
<h3 id="11-docker-images-a"><a href="#11-docker-images-a" class="headerlink" title="11. docker images -a"></a>11. docker images -a</h3><p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022332.jpg" alt="image-20181107192154611"></p>
<h3 id="12-docker-run-p-1024-8080-t-cloudcomb-sun-1-0"><a href="#12-docker-run-p-1024-8080-t-cloudcomb-sun-1-0" class="headerlink" title="12.docker run -p 1024:8080 -t cloudcomb/sun:1.0 ."></a>12.docker run -p 1024:8080 -t cloudcomb/sun:1.0 .</h3><blockquote>
<p>注意 cloudcomb和前面的cloudcomb要一一对应</p>
<p>1024 与8080是一一对应的关系</p>
<p>Error: Unable to access jarfile /app.jar</p>
<p>⭐️ ADD user-server-0.0.1-SNAPSHOT.jar app.jar 要和pom的<artifactid>user-server</artifactid></p>
<p>保持名字一样，不然maven打出来的包，docker找不到。</p>
<ul>
<li>最终的结局办法 好像是将copy去掉了 注意看控制台打印的信息 兄dei</li>
</ul>
</blockquote>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022334.jpg" alt="image-20181107192857396"></p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022336.jpg" alt="image-20181107193127019"></p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022338.jpg" alt="image-20181107193051806"></p>
<p>DockerFile：</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022340.jpg" alt="image-20181107193402453"></p>
<blockquote>
<p>Docker就是给一名字 gs-spring-bbot</p>
</blockquote>
<p>贴一个Dockerfilr。</p>
<ul>
<li style="list-style: none"><input type="checkbox" checked> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">FROM hub.c.163.com/xbingo/jdk8:latest</span><br><span class="line"></span><br><span class="line">from hub.c.163.com/library/tomcat</span><br><span class="line"></span><br><span class="line">MAINTAINER Freemana2017 1047629166@qq.com</span><br><span class="line"></span><br><span class="line">ADD  atcrodfunding3_ssm-0.0.1-SNAPSHOT.jar app.jar</span><br><span class="line"></span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br><span class="line"></span><br><span class="line">COPY atcrod.war /usr/local/tomcat/webapps</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">#FROM openjdk:8-jdk-alpine</span><br><span class="line">#VOLUME /tmp</span><br><span class="line">#ADD  atcrodfunding3_ssm-0.0.1-SNAPSHOT.jar app.jar</span><br><span class="line">#ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br><span class="line">#</span><br><span class="line"> </span><br><span class="line">#FROM hub.c.163.com/xbingo/jdk8:latest</span><br><span class="line">#</span><br><span class="line">#ADD gs-spring-boot-docker-0.1.0.jar app.jar</span><br><span class="line">#</span><br><span class="line">#ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">#这个 Dockerfile 文件很简单，构建 Jdk 基础环境，添加 Spring Boot Jar 到镜像中，简单解释一下:</span><br><span class="line">#</span><br><span class="line">#FROM ，表示使用 Jdk8 环境 为基础镜像，如果镜像不是本地的会从 DockerHub 进行下载</span><br><span class="line">#VOLUME ，VOLUME 指向了一个/tmp的目录，由于 Spring Boot 使用内置的Tomcat容器，Tomcat 默认使用/tmp作为工作目录。这个命令的效果是：</span><br><span class="line">#在宿主机的/var/lib/docker目录下创建一个临时文件并把它链接到容器中的/tmp目录</span><br><span class="line">#ADD ，拷贝文件并且重命名</span><br><span class="line">#ENTRYPOINT ，为了缩短 Tomcat 的启动时间，添加java.security.egd的系统属性指向/dev/urandom作为 ENTRYPOINT</span><br><span class="line">#这样 Spring Boot 项目添加 Docker 依赖就完成了。</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<p>Dockerfile 用的war要有Tomcat </p>
<p>自己理解吧 多看一些视频笔记什么的 反正很难,,,</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022341.jpg" alt="image-20181107184402451"></p>
<hr>
<hr>
<hr>
<h1 id="以上的文件是从github上拉的-现在自己构建SpringBoot-jar的应用"><a href="#以上的文件是从github上拉的-现在自己构建SpringBoot-jar的应用" class="headerlink" title="以上的文件是从github上拉的 现在自己构建SpringBoot -jar的应用"></a>以上的文件是从github上拉的 现在自己构建SpringBoot -jar的应用</h1><blockquote>
<p>通过群里的指导 估计jar打包和war打包区别不大吧</p>
<p>下面通过SpringBoot构建Docker部署一下试试</p>
<p><a href="https://waylau.com/docker-spring-boot/" target="_blank" rel="noopener">https://waylau.com/docker-spring-boot/</a></p>
<p><a href="http://www.ityouknow.com/springboot/2018/03/19/spring-boot-docker.html" target="_blank" rel="noopener">http://www.ityouknow.com/springboot/2018/03/19/spring-boot-docker.html</a></p>
<p><a href="https://lw900925.github.io/docker/docker-springboot.html" target="_blank" rel="noopener">https://lw900925.github.io/docker/docker-springboot.html</a></p>
<p><a href="https://www.tianmaying.com/tutorial/spring-boot-docker" target="_blank" rel="noopener">https://www.tianmaying.com/tutorial/spring-boot-docker</a></p>
</blockquote>
<blockquote>
<p><a href="https://bingohuang.com/spring-boot-docker/" target="_blank" rel="noopener">https://bingohuang.com/spring-boot-docker/</a></p>
</blockquote>
<blockquote>
<p><a href="https://www.imooc.com/search/?words=docker" target="_blank" rel="noopener">https://www.imooc.com/search/?words=docker</a></p>
</blockquote>
<blockquote>
<p><a href="http://www.ityouknow.com/docker/2018/03/30/docker-machine.html" target="_blank" rel="noopener">http://www.ityouknow.com/docker/2018/03/30/docker-machine.html</a></p>
<p><a href="https://spring.io/guides/gs/spring-boot-docker/" target="_blank" rel="noopener">https://spring.io/guides/gs/spring-boot-docker/</a></p>
</blockquote>
<h2 id="SpringBoot-Docker"><a href="#SpringBoot-Docker" class="headerlink" title="SpringBoot Docker"></a>SpringBoot Docker</h2><blockquote>
<p><a href="https://lw900925.github.io/docker/docker-springboot.html" target="_blank" rel="noopener">https://lw900925.github.io/docker/docker-springboot.html</a></p>
</blockquote>
<p><a href="http://www.ityouknow.com/springboot/2018/03/19/spring-boot-docker.html" target="_blank" rel="noopener">http://www.ityouknow.com/springboot/2018/03/19/spring-boot-docker.html</a> 主要环节</p>
<p><img src="http://ipic-freemana-1257703707.cos.ap-shanghai.myqcloud.com/2019-04-29-022342.jpg" alt="image-20181110214317827"></p>
<p><img src="/Users/apple/Library/Application Support/typora-user-images/image-20181115165826700.png" alt="image-20181115165826700"></p>
<p>$ sudo docker tag [ImageId] ccr.ccs.tencentyun.com/[namespace]/[ImageName]:[镜像版本号]<br>$ sudo docker push ccr.ccs.tencentyun.com/[namespace]/[ImageName]:[镜像版本号]</p>
<p>⭐️</p>
<p> sudo docker tag 5fc4ede68fcd ccr.ccs.tencentyun.com/atcrod/latest</p>
<p> sudo docker push ccr.ccs.tencentyun.com/atcrod/latest</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://ws2.sinaimg.cn/large/006tNbRwgy1fy0kf0oua7j30ow0ow3zs.jpg" alt="袁海鹏">
            
              <p class="site-author-name" itemprop="name">袁海鹏</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">133</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">51</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        


<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">袁海鹏</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>




<div class="powered-by">
<i class="fa fa-user-md"></i>

<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>


</div>





  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
    

    

  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>


